<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/15/2025 4:52:43 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="11-VM-PGR01"
  DTS:CreatorName="AGROHOLD\a.d.rogov"
  DTS:DTSID="{884CFD7F-45E7-4B9C-9B1F-87129EE306B3}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="17.0.1008.3"
  DTS:LocaleID="1033"
  DTS:ObjectName="ETLPackage"
  DTS:PackageType="5"
  DTS:VersionBuild="108"
  DTS:VersionGUID="{763EE8AF-9980-4EA1-A425-CFC3A552B3AA}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[11-vm-csbsql]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{9DB9A5A9-1B97-4FC6-835B-F1FF8893FE77}"
      DTS:ObjectName="11-vm-csbsql">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=11-vm-csbsql;Provider=MSOLEDBSQL.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[11-VM-CSBSQL.CSB]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
      DTS:ObjectName="11-VM-CSBSQL.CSB">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=11-VM-CSBSQL;Initial Catalog=CSB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-Package-{15E5B8D5-5D7C-40CD-A746-AB4423273A56}11-VM-CSBSQL.CSB;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[11-VM-CSBSQL.CSB 1]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{AA32BB74-12F2-4C8A-A1AB-6FE445328ACE}"
      DTS:ObjectName="11-VM-CSBSQL.CSB 1">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=11-VM-CSBSQL;Initial Catalog=CSB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-ETLPackage-{AA32BB74-12F2-4C8A-A1AB-6FE445328ACE}11-VM-CSBSQL.CSB 1;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[11-vm-dwh01]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{F901B5F9-F2A9-4028-8394-937301B8EE8C}"
      DTS:ObjectName="11-vm-dwh01">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=11-vm-dwh01;Provider=MSOLEDBSQL.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[11-VM-DWH01.CSB_FK_REP]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
      DTS:ObjectName="11-VM-DWH01.CSB_FK_REP">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=11-VM-DWH01;Initial Catalog=CSB_FK_REP;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-Package-{3FD8FD07-CA07-4901-A194-624194D3CD2F}11-VM-DWH01.CSB_FK_REP;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SMTP Connection Manager]"
      DTS:CreationName="SMTP"
      DTS:DTSID="{ED11153F-0C94-48DD-BF81-8408FF4777E8}"
      DTS:ObjectName="SMTP Connection Manager">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=;UseWindowsAuthentication=True;EnableSsl=False;"
          ConnectByProxy="False" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SMTP Connection Manager 1]"
      DTS:CreationName="SMTP"
      DTS:Description="smtp"
      DTS:DTSID="{33BD7C01-8AF5-49DC-A094-75159DC3C491}"
      DTS:ObjectName="SMTP Connection Manager 1">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=smtp.agrohold.ru;UseWindowsAuthentication=True;EnableSsl=False;Timeout=1000;"
          ConnectByProxy="False" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{AB75B5D2-16A1-4310-AF09-C9961AF87CEA}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="HasMismatches">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F026D497-8EE6-4F19-8D59-15AB0C72D1B3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="RetryCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\CheckCollisions133"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{79E07C94-B571-4C67-9C6B-15AABAF90DEB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="CheckCollisions133"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="SELECT&#xA;&#x9;CASE WHEN count(*)&#xA;&#x9; &gt; 0 THEN 1 ELSE 0 END AS cnt&#xA;FROM (&#xA;&#x9;SELECT 1 as 'one' FROM cp_DWH_KA0133 WITH (NOLOCK)&#xA;&#x9;HAVING COUNT(*) &lt;&gt; (SELECT count(*) as cnt from  [11-VM-CSBSQL].[CSB].[dbo].[ka0133_00113] WITH (NOLOCK)&#xA;&#x9;)&#xA;) mismatches;"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\CheckCollisions52"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{a32ce898-0adc-4564-9a7f-680e6eaa5fc5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="CheckCollisions52"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="SELECT &#xA;    CASE &#xA;        WHEN COUNT(*) &gt; 0 THEN 1 &#xA;        ELSE 0 &#xA;    END AS HasMismatches&#xA;FROM (&#xA;    SELECT &#xA;        t1.cnt AS DWH_Count,&#xA;        t2.cnt AS ERP_Count&#xA;    FROM &#xA;        (VALUES &#xA;            ('cp_DWH_LA0052_202501', (SELECT COUNT(*) FROM cp_DWH_LA0052_202501)),&#xA;            ('cp_DWH_LA0052_202502', (SELECT COUNT(*) FROM cp_DWH_LA0052_202502)),&#xA;            ('cp_DWH_LA0052_202503', (SELECT COUNT(*) FROM cp_DWH_LA0052_202503)),&#xA;            ('cp_DWH_LA0052_202504', (SELECT COUNT(*) FROM cp_DWH_LA0052_202504)),&#xA;            ('cp_DWH_LA0052_202505', (SELECT COUNT(*) FROM cp_DWH_LA0052_202505)),&#xA;            ('cp_DWH_LA0052_202506', (SELECT COUNT(*) FROM cp_DWH_LA0052_202506)),&#xA;            ('cp_DWH_LA0052_202507', (SELECT COUNT(*) FROM cp_DWH_LA0052_202507)),&#xA;            ('cp_DWH_LA0052_202508', (SELECT COUNT(*) FROM cp_DWH_LA0052_202508)),&#xA;            ('cp_DWH_LA0052_202509', (SELECT COUNT(*) FROM cp_DWH_LA0052_202509)),&#xA;            ('cp_DWH_LA0052_202510', (SELECT COUNT(*) FROM cp_DWH_LA0052_202510)),&#xA;            ('cp_DWH_LA0052_202511', (SELECT COUNT(*) FROM cp_DWH_LA0052_202511))&#xA;        ) AS t1(name, cnt)&#xA;    JOIN &#xA;        (VALUES &#xA;            ('la0052_001_202501_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202501_ls10])),&#xA;            ('la0052_001_202502_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202502_ls10])),&#xA;            ('la0052_001_202503_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202503_ls10])),&#xA;            ('la0052_001_202504_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202504_ls10])),&#xA;            ('la0052_001_202505_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202505_ls10])),&#xA;            ('la0052_001_202506_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202506_ls10])),&#xA;            ('la0052_001_202507_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202507_ls10])),&#xA;            ('la0052_001_202508_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202508_ls10])),&#xA;            ('la0052_001_202509_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202509_ls10])),&#xA;            ('la0052_001_202510_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202510_ls10])),&#xA;            ('la0052_001_202511_ls10', (SELECT COUNT(*) FROM [11-VM-CSBSQL].[CSB].[dbo].[la0052_001_202511_ls10]))&#xA;        ) AS t2(name, cnt)&#xA;        ON SUBSTRING(t1.name, LEN(t1.name) - 5, 6) = SUBSTRING(t2.name, 12, 6)&#xA;    WHERE t1.cnt != t2.cnt&#xA;) mismatches;"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::HasMismatches" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Finall etl proces"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{90FD076F-C746-4FA3-914E-2AE706DB720A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Finall etl proces"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="INSERT&#xA;&#x9;&#xA;INTO ETL_log &#xA;select &#xA;GETDATE()&#xA;&#x9;, 'true'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\from_temp_erp_to_t_dwh"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E9C73A43-0D8F-41A2-B987-28C0875BB035}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="from_temp_erp_to_t_dwh"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="&#xA;    -- Insert statements for procedure here&#xA;&#x9;IF object_id(N'tempdb..#cp_DWH_KA0133_SSIS', N'U') is not null drop table dbo.#cp_DWH_KA0133_SISS;&#xA;&#x9;&#xA;&#x9;&#xA;&#x9;SELECT * into #cp_DWH_KA0133_SSIS from [11-VM-CSBSQL].[CSB].[dbo].[temp_DWH_KA0133_SSIS]&#xA;&#x9;&#xA;UPDATE cp_DWH_KA0133_SSIS with (updlock,serializable)&#xA;SET KA0133_PLAN_DATUM&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_PLAN_DATUM&#xA;&#x9;&#x9;,KA0133_PROD_KST_NR&#x9;&#x9;&#x9;= tab1.KA0133_PROD_KST_NR&#xA;&#x9;&#x9;,KA0133_PRIORITAET&#x9;&#x9;&#x9;= tab1.KA0133_PRIORITAET&#xA;&#x9;&#x9;,KA0133_REZ_NR&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_REZ_NR&#xA;&#x9;&#x9;,KA0133_VAR_NR&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_VAR_NR&#xA;&#x9;&#x9;,KA0133_PROD_AUFTR_NR&#x9;&#x9;= tab1.KA0133_PROD_AUFTR_NR&#xA;&#x9;&#x9;,KA0133_PROD_AUFTR_LFD_NR&#x9;= tab1.KA0133_PROD_AUFTR_LFD_NR&#xA;&#x9;&#x9;,KA0133_REC_NR&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_REC_NR &#xA;&#x9;&#x9;,KA0133_REZ_VERS_NR&#x9;&#x9;&#x9;= tab1.KA0133_REZ_VERS_NR &#xA;&#x9;&#x9;,KA2422_CHARGEN_NR&#x9;&#x9;&#x9;= tab1.KA2422_CHARGEN_NR&#xA;&#x9;&#x9;,KA0133_ABG_KST_NR&#x9;&#x9;&#x9;= tab1.KA0133_ABG_KST_NR&#xA;&#x9;&#x9;,KA0133_STATUS&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_STATUS&#xA;&#x9;&#x9;,KA0133_NF_REZ_NR&#x9;&#x9;&#x9;= tab1.KA0133_NF_REZ_NR&#xA;&#x9;&#x9;,KA0133_NF_VAR_NR&#x9;&#x9;&#x9;= tab1.KA0133_NF_VAR_NR&#xA;&#x9;&#x9;,KA0133_NF_PROD_AUFTR_NR&#x9;= tab1.KA0133_NF_PROD_AUFTR_NR &#xA;&#x9;&#x9;,KA0133_NF_PROD_AUFTR_LFD_NR = tab1.KA0133_NF_PROD_AUFTR_LFD_NR&#xA;&#x9;&#x9;,KA0133_NF_PROD_KST_NR&#x9;&#x9;= tab1.KA0133_NF_PROD_KST_NR &#xA;&#x9;&#x9;,KA0133_CHAR_GR_SGE&#x9;&#x9;&#x9;= tab1.KA0133_CHAR_GR_SGE&#xA;&#x9;&#x9;,KA0133_GES_MENGE_SGE&#x9;&#x9;= tab1.KA0133_GES_MENGE_SGE&#xA;&#x9;&#x9;,KA0133_PLAN_CHAR_GR&#x9;&#x9;= tab1.KA0133_PLAN_CHAR_GR&#xA;&#x9;&#x9;,KA0133_START_DATUM_SOLL&#x9;= tab1.KA0133_START_DATUM_SOLL&#xA;&#x9;&#x9;,KA0133_START_ZEIT_SOLL&#x9;&#x9;= tab1.KA0133_START_ZEIT_SOLL&#xA;&#x9;&#x9;,KA0133_ENDE_DATUM_SOLL&#x9;&#x9;= tab1.KA0133_ENDE_DATUM_SOLL&#xA;&#x9;&#x9;,KA0133_ENDE_ZEIT_SOLL&#x9;&#x9;= tab1.KA0133_ENDE_ZEIT_SOLL&#xA;&#x9;&#x9;,KA0133_START_DATUM_IST&#x9;&#x9;= tab1.KA0133_START_DATUM_IST&#xA;&#x9;&#x9;,KA0133_START_ZEIT_IST&#x9;&#x9;= tab1.KA0133_START_ZEIT_IST&#xA;&#x9;&#x9;,KA0133_ENDE_DATUM_IST&#x9;&#x9;= tab1.KA0133_ENDE_DATUM_IST&#xA;&#x9;&#x9;,KA0133_ENDE_ZEIT_IST&#x9;&#x9;= tab1.KA0133_ENDE_ZEIT_IST&#xA;&#x9;&#x9;,KA0133_MHD&#x9;&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_MHD&#xA;&#x9;&#x9;,KA0133_ANZ_CHARGEN&#x9;&#x9;&#x9;= tab1.KA0133_ANZ_CHARGEN&#xA;&#x9;&#x9;,KA0133_ANZ_CHARGEN_GENAU&#x9;= tab1.KA0133_ANZ_CHARGEN_GENAU&#xA;&#x9;&#x9;,KA0133_ANZ_CHARGEN_IST&#x9;&#x9;= tab1.KA0133_ANZ_CHARGEN_IST&#xA;&#x9;&#x9;,KA0133_FA_BS_NR&#x9;&#x9;&#x9;= tab1.KA0133_FA_BS_NR&#xA;&#x9;&#x9;,KA0133_FA_ADR_NR&#x9;&#x9;&#x9;= tab1.KA0133_FA_ADR_NR&#xA;&#x9;&#x9;,KA0133_VAR_ERM&#x9;&#x9;&#x9;&#x9;= tab1.KA0133_VAR_ERM&#xA;&#x9;&#x9;,KA0133_GEDRUCKT&#x9;&#x9;&#x9;= tab1.KA0133_GEDRUCKT&#xA;&#x9;&#x9;,KA0133_CFG_GEN_CH_POSTEN&#x9;= tab1.KA0133_CFG_GEN_CH_POSTEN&#xA;&#x9;&#x9;,KA0133_CFG_CH_P_EMPF_LT&#x9;= tab1.KA0133_CFG_CH_P_EMPF_LT&#xA;&#x9;&#x9;,KA0133_ANL_DATUM&#x9;&#x9;&#x9;= tab1.KA0133_ANL_DATUM&#xA;&#x9;&#x9;,KA0133_ANL_ZEIT&#x9;&#x9;&#x9;= tab1.KA0133_ANL_ZEIT&#xA;&#x9;&#x9;,KA0133_ANL_USER&#x9;&#x9;&#x9;= tab1.KA0133_ANL_USER&#xA;&#x9;&#x9;,KA0133_UPD_DATUM&#x9;&#x9;&#x9;= tab1.KA0133_UPD_DATUM&#xA;&#x9;&#x9;,KA0133_UPD_ZEIT&#x9;&#x9;&#x9;= tab1.KA0133_UPD_ZEIT&#xA;&#x9;&#x9;,KA0133_UPD_USER&#x9;&#x9;&#x9;= tab1.KA0133_UPD_USER&#xA;&#x9;FROM cp_DWH_KA0133_SSIS inner join #cp_DWH_KA0133_SSIS tab1 on cp_DWH_KA0133_SSIS.KA0133_REC_NR = tab1.KA0133_REC_NR AND cp_DWH_KA0133_SSIS.KA2422_CHARGEN_NR = tab1.KA2422_CHARGEN_NR &#x9;&#x9;&#x9;&#xA;INSERT cp_DWH_KA0133_SSIS select * from dbo.#cp_DWH_KA0133_SSIS tab1&#xA;&#x9;WHERE not exists (select KA0133_REC_NR,KA2422_CHARGEN_NR FROM cp_DWH_KA0133_SSIS WHERE cp_DWH_KA0133_SSIS.KA0133_REC_NR = tab1.KA0133_REC_NR AND cp_DWH_KA0133_SSIS.KA2422_CHARGEN_NR = tab1.KA2422_CHARGEN_NR)&#xA;DELETE FROM cp_DWH_KA0133_SSIS where KA0133_STATUS in (1, 3) or KA0133_PLAN_CHAR_GR = 1 OR (NOT EXISTS(&#xA;&#x9;SELECT KA0133_REC_NR&#xA;&#x9;FROM [11-VM-CSBSQL].[CSB].[dbo].[ka0133_00113] with(nolock)&#xA;&#x9;WHERE cp_DWH_KA0133_SSIS.KA0133_REC_NR = KA0133_REC_NR) AND KA0133_PLAN_DATUM &gt;= CONVERT(varchar(8),DATEADD(MONTH,-1,GETDATE()),112))&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\from_temp_erp_to_t_dwh 2461"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{e64d68f2-76c3-4941-b2ff-9a7f6d4e7ede}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="from_temp_erp_to_t_dwh 2461"
      DTS:ThreadHint="4">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="&#x9;&#xA;IF object_id(N'tempdb..#cp_DWH_KA2461_KA2446_SSIS', N'U') is not null drop table #cp_DWH_KA2461_KA2446_SSIS&#xA;&#xA;&#xA;SELECT * into #cp_DWH_KA2461_KA2446_SSIS from [11-VM-CSBSQL].[CSB].[dbo].[temp_DWH_KA2461_KA2446_SSIS]&#xA;&#x9;if object_id (N'dbo.cp_DWH_KA2461_KA2446_SSIS', N'U') is null BEGIN create table dbo.cp_DWH_KA2461_KA2446_SSIS (&#x9;&#xA;&#x9;KA2461_CHAR_NR  bigint not null--Номер партии&#xA;&#x9;,KA2461_PROD_AUFTR_NR bigint not null --Номер задания&#xA;&#x9;,KA2461_PROD_AUFTR_LFD_NR smallint not null --номер подзадания&#xA;&#x9;,KA2461_MAX_UNIQUE_NR int not null--количество компонентов&#xA;&#x9;,KA2461_STATUS tinyint not null --Статус партии&#xA;&#x9;,KA2461_PROD_KST_NR int not null --Буфер производства&#xA;&#x9;,KA2461_PROD_LT_NR bigint not null--?&#xA;&#x9;,KA2461_PROD_LT_DATUM int not null--Дата буфера производства&#xA;&#x9;,KA2461_PROD_LT_LOS nchar(20)--ЛОТ буфера производства&#xA;&#x9;,KA2461_EMPF_KST_NR int not null --Буфер выхода&#xA;&#x9;,KA2461_EMPF_LT_NR bigint not null--? Номер буфера выхода&#xA;&#x9;,KA2461_EMPF_LT_DATUM int not null--Дата буфера выхода&#xA;&#x9;,KA2461_EMPF_LT_LOS nchar(20)--ЛОТ буфера выхода&#xA;&#x9;,KA2461_REZ_NR bigint not null--Артикул спецификации&#xA;&#x9;,KA2461_VAR_NR smallint not null--Вариант спецификации&#xA;&#x9;,KA2461_REZ_VERS_NR bigint not null--Версия варианта спецификации&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_BRU decimal(18,6) not null--Общий вес сацификации БРУТТО&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_NET decimal(18,6) not null--Общий вес спецификации НЕТТО&#xA;&#x9;,KA2461_REZ_STUECK_KALK tinyint not null --Калькуляционный код спецификации&#xA;&#x9;,KA2461_CHAR_GR_SOLL_PE_VK  decimal(18,6)--Объем производства ПЛАН&#xA;&#x9;,KA2461_CHAR_GR_IST_LE_VK decimal(18,6)--Объем производства, ФАКТ, СК&#xA;&#x9;,KA2461_CHAR_GR_IST_PE_VK  decimal(18,6)--Объем производства, ФАКТ, ЦЕ&#xA;&#x9;,KA2461_MHD int not null--Дата ОСГ&#xA;&#x9;,KA2461_PRIORITAET int not null--Приоритет производства&#xA;&#x9;,KA2461_START_DATUM_IST int not null&#xA;&#x9;,KA2461_START_ZEIT_IST int not null&#xA;&#x9;,KA2461_ENDE_DATUM_IST int not null&#xA;&#x9;,KA2461_ENDE_ZEIT_IST int not null&#xA;&#x9;,KA2461_UEBERN_STAT tinyint not null&#xA;&#x9;,KA2461_GEDRUCKT tinyint not null&#xA;&#x9;,KA2461_LAGERPREIS decimal(13,6)--цена&#xA;&#x9;,KA2461_WAEHRUNG nchar(4) not null--руб&#xA;&#x9;,KA2446_MENGE_KG_1 decimal(15,6) null--Объем (кг) 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_AKT_1 decimal(15,6) null--Цена ФАКТ 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_DUR_1 decimal(15,6) null--Цена ПЛАН 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_PRO_1 decimal(15,6) null--Цена СЕ 1 ступень (сырье)&#xA;&#x9;,KA2446_MENGE_KG_3 decimal(15,3) null--Объем (кг) 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_AKT_3 decimal(15,6) null--Цена ФАКТ 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_DUR_3 decimal(15,6) null--Цена ПЛАН 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_PRO_3 decimal(15,6) null--Цена СЕ 3 ступень (упаковка)&#xA;&#x9;,KA2461_ANL_DATUM int not null&#xA;&#x9;,KA2461_ANL_ZEIT int not null&#xA;&#x9;,KA2461_UPD_DATUM int not null&#xA;&#x9;,KA2461_UPD_ZEIT int not null&#xA;&#x9;,KA2461_UPD_USER int)&#xA;&#x9;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\from_temp_erp_to_t_erp 2461"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{12ac3298-94b2-42b6-8e47-187c1ef01f20}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="from_temp_erp_to_t_erp 2461"
      DTS:ThreadHint="4">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="&#x9;&#x9;&#xA;declare @nowdate datetime = GETDATE() ,@yesterday datetime = DATEADD(DAY,-2,GETDATE())&#xA;&#x9;declare @yesterday_date int = convert(nchar(8),dateadd(DAY,-2,getdate()),112)&#xA;&#xA;IF object_id(N'tempdb..#temp_DWH_KA2461_KA2446_SSIS', N'U') is not null drop table dbo.#temp_DWH_KA2461_KA2446_SSIS;&#xA;&#xA;select KA2461_CHAR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_LFD_NR&#xA;&#x9;,KA2461_MAX_UNIQUE_NR&#xA;&#x9;,KA2461_STATUS&#xA;&#x9;,KA2461_PROD_KST_NR&#xA;&#x9;,KA2461_PROD_LT_NR&#xA;&#x9;,KA2461_PROD_LT_DATUM&#xA;&#x9;,KA2461_PROD_LT_LOS&#xA;&#x9;,KA2461_EMPF_KST_NR&#xA;&#x9;,KA2461_EMPF_LT_NR&#xA;&#x9;,KA2461_EMPF_LT_DATUM&#xA;&#x9;,KA2461_EMPF_LT_LOS&#xA;&#x9;,KA2461_REZ_NR&#xA;&#x9;,KA2461_VAR_NR&#xA;&#x9;,KA2461_REZ_VERS_NR&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_BRU&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_NET&#xA;&#x9;,KA2461_REZ_STUECK_KALK&#xA;&#x9;,KA2461_CHAR_GR_SOLL_PE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_LE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_PE_VK&#xA;&#x9;,KA2461_MHD&#xA;&#x9;,KA2461_PRIORITAET&#xA;&#x9;,KA2461_START_DATUM_IST&#xA;&#x9;,KA2461_START_ZEIT_IST&#xA;&#x9;,KA2461_ENDE_DATUM_IST &#xA;&#x9;,KA2461_ENDE_ZEIT_IST&#xA;&#x9;,KA2461_UEBERN_STAT&#xA;&#x9;,KA2461_GEDRUCKT &#xA;&#x9;,KA2461_LAGERPREIS &#xA;&#x9;,KA2461_WAEHRUNG &#xA;&#x9;,KA2446_MENGE_KG_1  &#xA;&#x9;,KA2446_WERT_AKT_1  &#xA;&#x9;,KA2446_WERT_DUR_1  &#xA;&#x9;,KA2446_WERT_PRO_1  &#xA;&#x9;,KA2446_MENGE_KG_3  &#xA;&#x9;,KA2446_WERT_AKT_3  &#xA;&#x9;,KA2446_WERT_DUR_3  &#xA;&#x9;,KA2446_WERT_PRO_3 &#xA;&#x9;,KA2461_ANL_DATUM &#xA;&#x9;,KA2461_ANL_ZEIT&#xA;&#x9;,KA2461_UPD_DATUM&#xA;&#x9;,KA2461_UPD_ZEIT&#xA;&#x9;,KA2461_UPD_USER&#xA;into [dbo].#temp_DWH_KA2461_KA2446_SSIS from [CSB].[dbo].[ka2461_00105] with(nolock) left join [CSB].[dbo].[KA2446_00103] with(nolock) on KA2461_CHAR_NR = KA2446_CHARGEN_NR&#xA;&#x9;where dbo.Convert_CSB_Date_Time(KA2461_UPD_DATUM, KA2461_UPD_ZEIT) &gt;= @yesterday&#xA;&#x9;&#xA;update temp_DWH_KA2461_KA2446_SSIS with (updlock,serializable)&#xA;set KA2461_CHAR_NR&#x9;&#x9;&#x9;&#x9;= tab2.KA2461_CHAR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_NR&#x9;&#x9;= tab2.KA2461_PROD_AUFTR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_LFD_NR&#x9;= tab2.KA2461_PROD_AUFTR_LFD_NR&#xA;&#x9;,KA2461_MAX_UNIQUE_NR&#x9;&#x9;= tab2.KA2461_MAX_UNIQUE_NR&#xA;&#x9;,KA2461_STATUS&#x9;&#x9;&#x9;&#x9;= tab2.KA2461_STATUS&#xA;&#x9;,KA2461_PROD_KST_NR&#x9;&#x9;&#x9;= tab2.KA2461_PROD_KST_NR&#xA;&#x9;,KA2461_PROD_LT_NR&#x9;&#x9;&#x9;= tab2.KA2461_PROD_LT_NR&#xA;&#x9;,KA2461_PROD_LT_DATUM&#x9;&#x9;= tab2.KA2461_PROD_LT_DATUM&#xA;&#x9;,KA2461_PROD_LT_LOS&#x9;&#x9;&#x9;= tab2.KA2461_PROD_LT_LOS&#xA;&#x9;,KA2461_EMPF_KST_NR&#x9;&#x9;&#x9;= tab2.KA2461_EMPF_KST_NR&#xA;&#x9;,KA2461_EMPF_LT_NR&#x9;&#x9;&#x9;= tab2.KA2461_EMPF_LT_NR&#xA;&#x9;,KA2461_EMPF_LT_DATUM&#x9;&#x9;= tab2.KA2461_EMPF_LT_DATUM&#xA;&#x9;,KA2461_EMPF_LT_LOS&#x9;&#x9;&#x9;= tab2.KA2461_EMPF_LT_LOS&#xA;&#x9;,KA2461_REZ_NR&#x9;&#x9;&#x9;&#x9;= tab2.KA2461_REZ_NR&#xA;&#x9;,KA2461_VAR_NR&#x9;&#x9;&#x9;&#x9;= tab2.KA2461_VAR_NR&#xA;&#x9;,KA2461_REZ_VERS_NR&#x9;&#x9;&#x9;= tab2.KA2461_REZ_VERS_NR&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_BRU&#x9;= tab2.KA2461_REZ_GES_GEW_SGE_BRU&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_NET&#x9;= tab2.KA2461_REZ_GES_GEW_SGE_NET&#xA;&#x9;,KA2461_REZ_STUECK_KALK&#x9;&#x9;= tab2.KA2461_REZ_STUECK_KALK&#xA;&#x9;,KA2461_CHAR_GR_SOLL_PE_VK&#x9;= tab2.KA2461_CHAR_GR_SOLL_PE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_LE_VK&#x9;= tab2.KA2461_CHAR_GR_IST_LE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_PE_VK&#x9;= tab2.KA2461_CHAR_GR_IST_PE_VK&#xA;&#x9;,KA2461_MHD&#x9;&#x9;&#x9;&#x9;&#x9;= tab2.KA2461_MHD&#xA;&#x9;,KA2461_PRIORITAET&#x9;&#x9;&#x9;= tab2.KA2461_PRIORITAET&#xA;&#x9;,KA2461_START_DATUM_IST&#x9;&#x9;= tab2.KA2461_START_DATUM_IST&#xA;&#x9;,KA2461_START_ZEIT_IST&#x9;&#x9;= tab2.KA2461_START_ZEIT_IST&#xA;&#x9;,KA2461_ENDE_DATUM_IST&#x9;&#x9;= tab2.KA2461_ENDE_DATUM_IST&#xA;&#x9;,KA2461_ENDE_ZEIT_IST&#x9;&#x9;= tab2.KA2461_ENDE_ZEIT_IST&#xA;&#x9;,KA2461_UEBERN_STAT&#x9;&#x9;&#x9;= tab2.KA2461_UEBERN_STAT&#xA;&#x9;,KA2461_GEDRUCKT&#x9;&#x9;&#x9;= tab2.KA2461_GEDRUCKT&#xA;&#x9;,KA2461_LAGERPREIS&#x9;&#x9;&#x9;= tab2.KA2461_LAGERPREIS&#xA;&#x9;,KA2461_WAEHRUNG&#x9;&#x9;&#x9;= tab2.KA2461_WAEHRUNG&#xA;&#x9;,KA2446_MENGE_KG_1&#x9;&#x9;&#x9;= tab2.KA2446_MENGE_KG_1&#xA;&#x9;,KA2446_WERT_AKT_1&#x9;&#x9;&#x9;= tab2.KA2446_WERT_AKT_1&#xA;&#x9;,KA2446_WERT_DUR_1&#x9;&#x9;&#x9;= tab2.KA2446_WERT_DUR_1&#xA;&#x9;,KA2446_WERT_PRO_1&#x9;&#x9;&#x9;= tab2.KA2446_WERT_PRO_1&#xA;&#x9;,KA2446_MENGE_KG_3&#x9;&#x9;&#x9;= tab2.KA2446_MENGE_KG_3&#xA;&#x9;,KA2446_WERT_AKT_3&#x9;&#x9;&#x9;= tab2.KA2446_WERT_AKT_3&#xA;&#x9;,KA2446_WERT_DUR_3&#x9;&#x9;&#x9;= tab2.KA2446_WERT_DUR_3&#xA;&#x9;,KA2446_WERT_PRO_3&#x9;&#x9;&#x9;= tab2.KA2446_WERT_PRO_3&#xA;&#x9;,KA2461_ANL_DATUM&#x9;&#x9;&#x9;= tab2.KA2461_ANL_DATUM&#xA;&#x9;,KA2461_ANL_ZEIT&#x9;&#x9;&#x9;= tab2.KA2461_ANL_ZEIT&#xA;&#x9;,KA2461_UPD_DATUM&#x9;&#x9;&#x9;= tab2.KA2461_UPD_DATUM&#xA;&#x9;,KA2461_UPD_ZEIT&#x9;&#x9;&#x9;= tab2.KA2461_UPD_ZEIT&#xA;&#x9;,KA2461_UPD_USER&#x9;&#x9;&#x9;= tab2.KA2461_UPD_USER&#xA;&#x9;FROM temp_DWH_KA2461_KA2446_SSIS inner join #temp_DWH_KA2461_KA2446_SSIS tab2 on temp_DWH_KA2461_KA2446_SSIS.KA2461_CHAR_NR = tab2.KA2461_CHAR_NR&#x9;&#x9;&#x9;&#xA;INSERT temp_DWH_KA2461_KA2446_SSIS select * from #temp_DWH_KA2461_KA2446_SSIS tab2&#xA;&#x9;where not exists (select KA2461_CHAR_NR from temp_DWH_KA2461_KA2446_SSIS where KA2461_CHAR_NR = tab2.KA2461_CHAR_NR)&#xA;&#xA;&#x9;delete temp_DWH_KA2461_KA2446&#x9;where dbo.Convert_CSB_Date_Time(KA2461_UPD_DATUM, KA2461_UPD_ZEIT) &lt;= @yesterday&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Healing DWH2462"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{62DC8853-3300-46D6-A8DA-C25D11F92C5B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Healing DWH2462"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2025; © 2025 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="&#xA;IF DATEPART(weekday, GETDATE()) = 7&#xA;BEGIN &#xA;&#x9;DECLARE @cnt_erp INT;&#xA;&#x9;DECLARE @cnt_dwh INT;&#xA;&#xA;&#xA;&#xA;&#x9;SELECT @cnt_dwh = COUNT(*) &#xA;&#x9;FROM [11-vm-CSBSQL]. [CSB].[dbo].[ka2462_00104] WITH (NOLOCK)&#xA;&#xA;&#xA;&#x9; SELECT @cnt_erp = COUNT(*) &#xA;&#x9;FROM cp_DWH_KA2462&#xA;&#xA;&#xA;&#xA;&#x9;IF @cnt_dwh &lt;&gt; @cnt_erp &#xA;&#x9;BEGIN &#xA;&#x9;&#x9;TRUNCATE TABLE cp_DWH_KA2462&#xA;&#x9;&#x9;INSERT INTO dbo.cp_DWH_KA2462 (&#xA;    [KA2462_CHAR_NR],&#xA;    [KA2462_CHAR_POSTEN_NR],&#xA;    [KA2462_UNIQUE_NR],&#xA;    [KA2462_ART_NR],&#xA;    [KA2462_ART_POS_LFD_NR],&#xA;    [KA2462_SPLITPOSTEN],&#xA;    [KA2462_SPLIT_QUELLPOSTEN_NR],&#xA;    [KA2462_SOLLMENGE_LE_EK],&#xA;    [KA2462_SOLLMENGE_PE_EK],&#xA;    [KA2462_ISTMENGE_LE_EK],&#xA;    [KA2462_ISTMENGE_PE_EK],&#xA;    [KA2462_ANT_AN_GES_MENGE],&#xA;    [KA2462_ABG_KST_NR],&#xA;    [KA2462_ABG_LT_NR],&#xA;    [KA2462_ABG_LT_DATUM],&#xA;    [KA2462_ABG_LT_LOS],&#xA;    [KA2462_VERWOGEN],&#xA;    [KA2462_GEW_TYP],&#xA;    [KA2462_V_TW_TYP],&#xA;    [KA2462_V_TH_TYP],&#xA;    [KA2462_KEIN_GEW],&#xA;    [KA2462_NEBENPRODUKT],&#xA;    [KA2462_VERW_UPD_DATUM],&#xA;    [KA2462_VERW_UPD_ZEIT],&#xA;    [KA2462_VERW_UPD_USER],&#xA;    [KA2462_VERW_UPD_STATION],&#xA;    [KA2462_START_DATUM],&#xA;    [KA2462_START_ZEIT],&#xA;    [KA2462_ENDE_DATUM],&#xA;    [KA2462_ENDE_ZEIT],&#xA;    [KA2462_LAGERPREIS],&#xA;    [KA2462_WAEHRUNG],&#xA;    [KA2462_REZ_STUFE],&#xA;    [KA2462_REZ_STUFE_LFD_NR],&#xA;    [KA2462_BUCHUNGSART],&#xA;    [KA2462_ANL_DATUM],&#xA;    [KA2462_ANL_ZEIT],&#xA;    [KA2462_UPD_DATUM],&#xA;    [KA2462_UPD_ZEIT]&#xA;)&#xA;SELECT&#xA;&#x9;&#x9;&#x9;[CHAR_NR],&#xA;&#x9;&#x9;&#x9;[CHAR_POSTEN_NR],&#xA;&#x9;&#x9;&#x9;[UNIQUE_NR],&#xA;&#x9;&#x9;&#x9;[ART_NR],&#xA;&#x9;&#x9;&#x9;[ART_POS_LFD_NR],&#xA;&#x9;&#x9;&#x9;[SPLITPOSTEN],&#xA;&#x9;&#x9;&#x9;[SPLIT_QUELLPOSTEN_NR],&#xA;&#x9;&#x9;&#x9;[SOLLMENGE_LE_EK],&#xA;&#x9;&#x9;&#x9;[SOLLMENGE_PE_EK],&#xA;&#x9;&#x9;&#x9;[ISTMENGE_LE_EK],&#xA;&#x9;&#x9;&#x9;[ISTMENGE_PE_EK],&#xA;&#x9;&#x9;&#x9;[ANT_AN_GES_MENGE],&#xA;&#x9;&#x9;&#x9;[ABG_KST_NR],&#xA;&#x9;&#x9;&#x9;[ABG_LT_NR],&#xA;&#x9;&#x9;&#x9;[ABG_LT_DATUM],&#xA;&#x9;&#x9;&#x9;[ABG_LT_LOS],&#xA;&#x9;&#x9;&#x9;[VERWOGEN],&#xA;&#x9;&#x9;&#x9;[GEW_TYP],&#xA;&#x9;&#x9;&#x9;[V_TW_TYP],&#xA;&#x9;&#x9;&#x9;[V_TH_TYP],&#xA;&#x9;&#x9;&#x9;[KEIN_GEW],&#xA;&#x9;&#x9;&#x9;[NEBENPRODUKT],&#xA;&#x9;&#x9;&#x9;[VERW_UPD_DATUM],&#xA;&#x9;&#x9;&#x9;[VERW_UPD_ZEIT],&#xA;&#x9;&#x9;&#x9;[VERW_UPD_USER],&#xA;&#x9;&#x9;&#x9;[VERW_UPD_STATION],&#xA;&#x9;&#x9;&#x9;[START_DATUM],&#xA;&#x9;&#x9;&#x9;[START_ZEIT],&#xA;&#x9;&#x9;&#x9;[ENDE_DATUM],&#xA;&#x9;&#x9;&#x9;[ENDE_ZEIT],&#xA;&#x9;&#x9;&#x9;[LAGERPREIS],&#xA;&#x9;&#x9;&#x9;[WAEHRUNG],&#xA;&#x9;&#x9;&#x9;[REZ_STUFE],&#xA;&#x9;&#x9;&#x9;[REZ_STUFE_LFD_NR],&#xA;&#x9;&#x9;&#x9;[BUCHUNGSART],&#xA;&#x9;&#x9;&#x9;[ANL_DATUM],&#xA;&#x9;&#x9;&#x9;[ANL_ZEIT],&#xA;&#x9;&#x9;&#x9;[UPD_DATUM],&#xA;&#x9;&#x9;&#x9;[UPD_ZEIT]&#xA;&#x9;&#x9;FROM [11-VM-CSBSQL].[CSB].[dbo].[KA2462] AS src&#xA;&#x9;&#x9;&#xA;&#x9;END&#xA; END&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_CSB_52"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{58607a1d-36b0-4439-ae33-bbafb9bb213c}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_CSB_52"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="&#x9;DECLARE @select_LA0052 varchar(max), @select_previous_LA0052 varchar(max)  &#xA;&#x9;&#x9;&#x9;,@current_month nchar(6) = left(convert(nchar(8),getdate(),112),6) ,@previous_month nchar(6) = left(convert(nchar(8),DATEADD(month,-1,getdate()),112),6)&#xA;&#x9;&#x9;&#x9;,@update_insert_LA0052 varchar(max),@temp_table varchar(1000), @insert_LA0052_ONE_DAY nvarchar(max)&#xA;&#x9;&#x9;&#x9;,@current_datetime smalldatetime = cast(getdate() as smalldatetime)&#xA;&#x9;SET NOCOUNT ON;&#xA;&#x9;SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xA;&#x9;&#x9;IF object_id(N'tempdb..#temp_DWH_LA0052_SSIS', N'U') is not null drop table #temp_DWH_LA0052_SSIS;&#xA;&#x9;&#x9;IF OBJECT_ID(N'[dbo].[temp_DWH_LA0052_SSIS]',N'U') IS NULL BEGIN create table [dbo].[temp_DWH_LA0052_SSIS] &#xA;&#x9;&#x9;&#x9;(L52_REC_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_ART_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BW_TYP tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_1 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_2 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_ME decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_PREIS decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_IST decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_SOLL decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_KORREKTUR tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG bigint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG_SUB_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_SUB_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BUCHUNGS_TYP smallint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_IST decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_SOLL decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_BELEG_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_FOLGESATZ_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ADR_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ANBRUCH_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_GND_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_VATER_PROG smallint not null&#xA;&#x9;&#x9;&#x9;,L52_TEILENTNAHME_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTRB_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTV_TARA decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_STORNO_POSTEN tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_MERP_TICKET bigint not null&#xA;&#x9;&#x9;&#x9;,L52_PROCESS_ID bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE_AKTION tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_ART_WECHSEL tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_FIFO_BUCHUNG tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_BEWEGUNGS_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_ZEIT int not null&#xA;&#x9;&#x9;&#x9;,L52_USER int not null&#xA;&#x9;&#x9;&#x9;,L52_STATION smallint not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_STATION int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_ZEIT int not null) END&#xA;set @temp_table = '#temp_DWH_LA0052_SSIS'&#xA;set @select_la0052 = 'select L52_REC_NR&#xA;&#x9;,L52_KONTO_ID_1,L52_KONTO_ID_2,L52_ART_NR,L52_BW_TYP,L52_KST_NR_1,L52_LAGERTYP_NR_1,L52_LAGERTYP_DATUM_1,L52_LAGERTYP_LOS_1,L52_LAGERPLATZ_1,L52_KST_NR_2,L52_LAGERTYP_NR_2,L52_LAGERTYP_DATUM_2,L52_LAGERTYP_LOS_2,L52_LAGERPLATZ_2&#xA;&#x9;,L52_MENGE_LE,L52_MENGE_ME,L52_PREIS,L52_WERT_IST,L52_WERT_SOLL,L52_KORREKTUR,L52_AUFTRAG,L52_AUFTRAG_SUB_NR,L52_SUB_POSTEN_NR,L52_BUCHUNGS_TYP,L52_MENGE_VK_LE,L52_MENGE_VK,L52_WERT_VK_IST,L52_WERT_VK_SOLL&#xA;&#x9;,L52_BELEG_DATUM,L52_FOLGESATZ_KZ,L52_POSTEN_NR,L52_ADR_NR,L52_NVE,L52_OBER_NVE,L52_ZIEL_NVE,L52_ZIEL_OBER_NVE,L52_ANBRUCH_KZ,L52_GND_NR,L52_VATER_PROG,L52_TEILENTNAHME_KZ,L52_MTRB_KZ,L52_MTV_TARA&#xA;&#x9;,L52_STORNO_POSTEN,L52_STORNIERTE_REC_NR,L52_STORNIERTE_PERIODE,L52_STORNO_REC_NR,L52_STORNO_PERIODE,L52_MERP_TICKET,L52_PROCESS_ID,L52_NVE_AKTION,L52_ART_WECHSEL,L52_FIFO_BUCHUNG,L52_BEWEGUNGS_DATUM,L52_ZEIT,L52_USER,L52_STATION,L52_UPD_STATION,L52_UPD_DATUM,L52_UPD_ZEIT&#xA;&#x9;into ' +@temp_table+ ' from [CSB].[dbo].[la0052_001_'+ @current_month +'_ls10] with(nolock)&#xA;&#x9;where smalldatetimefromparts(L52_UPD_DATUM / 10000, L52_UPD_DATUM / 100 % 100, L52_UPD_DATUM % 100,00 + L52_UPD_ZEIT /10000,00+L52_UPD_ZEIT/100%100) &gt;= DATEADD(minute,-3,cast(getdate() as smalldatetime)) '&#xA;set @select_previous_la0052 = 'union select L52_REC_NR&#xA;&#x9;,L52_KONTO_ID_1,L52_KONTO_ID_2,L52_ART_NR,L52_BW_TYP,L52_KST_NR_1,L52_LAGERTYP_NR_1,L52_LAGERTYP_DATUM_1,L52_LAGERTYP_LOS_1,L52_LAGERPLATZ_1,L52_KST_NR_2,L52_LAGERTYP_NR_2,L52_LAGERTYP_DATUM_2,L52_LAGERTYP_LOS_2,L52_LAGERPLATZ_2&#xA;&#x9;,L52_MENGE_LE,L52_MENGE_ME,L52_PREIS,L52_WERT_IST,L52_WERT_SOLL,L52_KORREKTUR,L52_AUFTRAG,L52_AUFTRAG_SUB_NR,L52_SUB_POSTEN_NR,L52_BUCHUNGS_TYP,L52_MENGE_VK_LE,L52_MENGE_VK,L52_WERT_VK_IST,L52_WERT_VK_SOLL&#xA;&#x9;,L52_BELEG_DATUM,L52_FOLGESATZ_KZ,L52_POSTEN_NR,L52_ADR_NR,L52_NVE,L52_OBER_NVE,L52_ZIEL_NVE,L52_ZIEL_OBER_NVE,L52_ANBRUCH_KZ,L52_GND_NR,L52_VATER_PROG,L52_TEILENTNAHME_KZ,L52_MTRB_KZ,L52_MTV_TARA&#xA;&#x9;,L52_STORNO_POSTEN,L52_STORNIERTE_REC_NR,L52_STORNIERTE_PERIODE,L52_STORNO_REC_NR,L52_STORNO_PERIODE,L52_MERP_TICKET,L52_PROCESS_ID,L52_NVE_AKTION,L52_ART_WECHSEL,L52_FIFO_BUCHUNG,L52_BEWEGUNGS_DATUM,L52_ZEIT,L52_USER,L52_STATION,L52_UPD_STATION,L52_UPD_DATUM,L52_UPD_ZEIT&#xA;&#x9;into ' +@temp_table+ ' from [CSB].[dbo].[la0052_001_'+ @previous_month +'_ls10] with(nolock)&#xA;&#x9;where smalldatetimefromparts(L52_UPD_DATUM / 10000, L52_UPD_DATUM / 100 % 100, L52_UPD_DATUM % 100,00 + L52_UPD_ZEIT /10000,00+L52_UPD_ZEIT/100%100) &gt;= DATEADD(minute,-3,cast(getdate() as smalldatetime)) '&#xA;set @insert_LA0052_ONE_DAY = '&#xA;&#x9;&#x9;insert [dbo].[temp_DWH_LA0052_SSIS]&#xA;&#x9;&#x9;select * from '+@temp_table+' tab2 where not exists (select L52_REC_NR from [dbo].[temp_DWH_LA0052_SSIS] AS tab1 WITH(NOLOCK) where tab1.L52_REC_NR = tab2.L52_REC_NR);&#xA;&#x9;UPDATE [dbo].[temp_DWH_LA0052_SSIS]&#xA;&#x9;SET L52_REC_NR&#x9;&#x9;&#x9;= tab2.L52_REC_NR&#xA;&#x9;&#x9;,L52_KONTO_ID_1&#x9;&#x9;= tab2.L52_KONTO_ID_1&#xA;&#x9;&#x9;,L52_KONTO_ID_2&#x9;&#x9;= tab2.L52_KONTO_ID_2&#xA;&#x9;&#x9;,L52_ART_NR&#x9;&#x9;&#x9;= tab2.L52_ART_NR&#xA;&#x9;&#x9;,L52_BW_TYP&#x9;&#x9;&#x9;= tab2.L52_BW_TYP&#xA;&#x9;&#x9;,L52_KST_NR_1&#x9;&#x9;&#x9;= tab2.L52_KST_NR_1&#xA;&#x9;&#x9;,L52_LAGERTYP_NR_1&#x9;&#x9;= tab2.L52_LAGERTYP_NR_1&#xA;&#x9;&#x9;,L52_LAGERTYP_DATUM_1&#x9;= tab2.L52_LAGERTYP_DATUM_1&#xA;&#x9;&#x9;,L52_LAGERTYP_LOS_1&#x9;= tab2.L52_LAGERTYP_LOS_1&#xA;&#x9;&#x9;,L52_LAGERPLATZ_1&#x9;&#x9;= tab2.L52_LAGERPLATZ_1&#xA;&#x9;&#x9;,L52_KST_NR_2&#x9;&#x9;&#x9;= tab2.L52_KST_NR_2&#xA;&#x9;&#x9;,L52_LAGERTYP_NR_2&#x9;&#x9;= tab2.L52_LAGERTYP_NR_2&#xA;&#x9;&#x9;,L52_LAGERTYP_DATUM_2&#x9;= tab2.L52_LAGERTYP_DATUM_2&#xA;&#x9;&#x9;,L52_LAGERTYP_LOS_2&#x9;= tab2.L52_LAGERTYP_LOS_2&#xA;&#x9;&#x9;,L52_LAGERPLATZ_2&#x9;&#x9;= tab2.L52_LAGERPLATZ_2&#x9;&#xA;&#x9;&#x9;,L52_MENGE_LE&#x9;&#x9;&#x9;= tab2.L52_MENGE_LE&#xA;&#x9;&#x9;,L52_MENGE_ME&#x9;&#x9;&#x9;= tab2.L52_MENGE_ME&#xA;&#x9;&#x9;,L52_PREIS&#x9;&#x9;&#x9;&#x9;= tab2.L52_PREIS&#xA;&#x9;&#x9;,L52_WERT_IST&#x9;&#x9;&#x9;= tab2.L52_WERT_IST&#xA;&#x9;&#x9;,L52_WERT_SOLL&#x9;&#x9;&#x9;= tab2.L52_WERT_SOLL&#xA;&#x9;&#x9;,L52_KORREKTUR&#x9;&#x9;&#x9;= tab2.L52_KORREKTUR&#xA;&#x9;&#x9;,L52_AUFTRAG&#x9;&#x9;&#x9;= tab2.L52_AUFTRAG&#xA;&#x9;&#x9;,L52_AUFTRAG_SUB_NR&#x9;= tab2.L52_AUFTRAG_SUB_NR&#xA;&#x9;&#x9;,L52_SUB_POSTEN_NR&#x9;&#x9;= tab2.L52_SUB_POSTEN_NR&#xA;&#x9;&#x9;,L52_BUCHUNGS_TYP&#x9;&#x9;= tab2.L52_BUCHUNGS_TYP&#xA;&#x9;&#x9;,L52_MENGE_VK_LE&#x9;&#x9;= tab2.L52_MENGE_VK_LE&#xA;&#x9;&#x9;,L52_MENGE_VK&#x9;&#x9;&#x9;= tab2.L52_MENGE_VK&#xA;&#x9;&#x9;,L52_WERT_VK_IST&#x9;&#x9;= tab2.L52_WERT_VK_IST&#xA;&#x9;&#x9;,L52_WERT_VK_SOLL&#x9;&#x9;= tab2.L52_WERT_VK_SOLL&#xA;&#x9;&#x9;,L52_BELEG_DATUM&#x9;&#x9;= tab2.L52_BELEG_DATUM&#xA;&#x9;&#x9;,L52_FOLGESATZ_KZ&#x9;&#x9;= tab2.L52_FOLGESATZ_KZ&#xA;&#x9;&#x9;,L52_POSTEN_NR&#x9;&#x9;&#x9;= tab2.L52_POSTEN_NR&#xA;&#x9;&#x9;,L52_ADR_NR&#x9;&#x9;&#x9;= tab2.L52_ADR_NR&#xA;&#x9;&#x9;,L52_NVE&#x9;&#x9;&#x9;&#x9;= tab2.L52_NVE&#xA;&#x9;&#x9;,L52_OBER_NVE&#x9;&#x9;&#x9;= tab2.L52_OBER_NVE&#xA;&#x9;&#x9;,L52_ZIEL_NVE&#x9;&#x9;&#x9;= tab2.L52_ZIEL_NVE&#xA;&#x9;&#x9;,L52_ZIEL_OBER_NVE&#x9;&#x9;= tab2.L52_ZIEL_OBER_NVE&#xA;&#x9;&#x9;,L52_ANBRUCH_KZ&#x9;&#x9;= tab2.L52_ANBRUCH_KZ&#xA;&#x9;&#x9;,L52_GND_NR&#x9;&#x9;&#x9;= tab2.L52_GND_NR&#xA;&#x9;&#x9;,L52_VATER_PROG&#x9;&#x9;= tab2.L52_VATER_PROG&#xA;&#x9;&#x9;,L52_TEILENTNAHME_KZ&#x9;= tab2.L52_TEILENTNAHME_KZ&#xA;&#x9;&#x9;,L52_MTRB_KZ&#x9;&#x9;&#x9;= tab2.L52_MTRB_KZ&#xA;&#x9;&#x9;,L52_MTV_TARA&#x9;&#x9;&#x9;= tab2.L52_MTV_TARA&#xA;&#x9;&#x9;,L52_STORNO_POSTEN&#x9;&#x9;= tab2.L52_STORNO_POSTEN&#xA;&#x9;&#x9;,L52_STORNIERTE_REC_NR&#x9;= tab2.L52_STORNIERTE_REC_NR&#xA;&#x9;&#x9;,L52_STORNIERTE_PERIODE= tab2.L52_STORNIERTE_PERIODE&#xA;&#x9;&#x9;,L52_STORNO_REC_NR&#x9;&#x9;= tab2.L52_STORNO_REC_NR&#xA;&#x9;&#x9;,L52_STORNO_PERIODE&#x9;= tab2.L52_STORNO_PERIODE&#xA;&#x9;&#x9;,L52_MERP_TICKET&#x9;&#x9;= tab2.L52_MERP_TICKET&#xA;&#x9;&#x9;,L52_PROCESS_ID&#x9;&#x9;= tab2.L52_PROCESS_ID&#xA;&#x9;&#x9;,L52_NVE_AKTION&#x9;&#x9;= tab2.L52_NVE_AKTION&#xA;&#x9;&#x9;,L52_ART_WECHSEL&#x9;&#x9;= tab2.L52_ART_WECHSEL&#xA;&#x9;&#x9;,L52_FIFO_BUCHUNG&#x9;&#x9;= tab2.L52_FIFO_BUCHUNG&#xA;&#x9;&#x9;,L52_BEWEGUNGS_DATUM&#x9;= tab2.L52_BEWEGUNGS_DATUM&#xA;&#x9;&#x9;,L52_ZEIT&#x9;&#x9;&#x9;&#x9;= tab2.L52_ZEIT&#xA;&#x9;&#x9;,L52_USER&#x9;&#x9;&#x9;&#x9;= tab2.L52_USER&#xA;&#x9;&#x9;,L52_STATION&#x9;&#x9;&#x9;= tab2.L52_STATION&#xA;&#x9;&#x9;,L52_UPD_STATION&#x9;&#x9;= tab2.L52_UPD_STATION&#xA;&#x9;&#x9;,L52_UPD_DATUM&#x9;&#x9;&#x9;= tab2.L52_UPD_DATUM&#xA;&#x9;&#x9;,L52_UPD_ZEIT&#x9;&#x9;&#x9;= tab2.L52_UPD_ZEIT&#xA;&#x9;from [dbo].[temp_DWH_LA0052_SSIS]&#xA;&#x9;&#x9;inner join '+@temp_table+' AS tab2 on [temp_DWH_LA0052_SSIS].L52_REC_NR = tab2.L52_REC_NR;&#xA;&#x9;DELETE dbo.[temp_DWH_LA0052_SSIS] where cast(CONVERT(nvarchar(8),L52_UPD_DATUM,112) AS date) &lt;= DATEADD(day,-1,GETDATE())&#xA;&#x9;'&#xA;&#x9;IF (DATEPART(DAY,GETDATE()) = 1 and DATEPART(HOUR,GETDATE()) = 1 and DATEPART(MINUTE,GETDATE()) &lt;= 5 ) BEGIN&#xA;&#x9;&#x9;exec(@select_la0052+@select_previous_la0052+@insert_LA0052_ONE_DAY); END&#xA;&#x9;ELSE BEGIN&#xA;&#x9;&#x9;exec(@select_la0052+@insert_LA0052_ONE_DAY); END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_csb_to_temp_csb2462"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{0926b7f7-8bd7-4a9e-b1b8-3b5d554d3c46}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_csb_to_temp_csb2462"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="&#x9;&#xA;&#xA;&#x9;declare @nowdate datetime = GETDATE() ,@yesterday datetime = DATEADD(DAY,-2,GETDATE())&#xA;&#x9;declare @yesterday_date int = convert(nchar(8),dateadd(DAY,-2,getdate()),112)&#xA;&#xA;&#x9;&#xA;&#x9;IF OBJECT_ID(N'tempdb..#temp_DWH_KA2462_SSIS', N'U') is not null BEGIN drop table dbo.#temp_DWH_KA2462_SSIS END&#xA;&#x9;&#xA;IF OBJECT_ID(N'temp_DWH_KA2462_SSIS', N'U') is null BEGIN create table dbo.temp_DWH_KA2462_SSIS(&#xA;&#x9;[KA2462_CHAR_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_CHAR_POSTEN_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_UNIQUE_NR] [int] NOT NULL,&#xA;&#x9;[KA2462_ART_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ART_POS_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_SPLITPOSTEN] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_SPLIT_QUELLPOSTEN_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_SOLLMENGE_LE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_SOLLMENGE_PE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ISTMENGE_LE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ISTMENGE_PE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ANT_AN_GES_MENGE] [float] NOT NULL,&#xA;&#x9;[KA2462_ABG_KST_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_LOS] [nchar](20) COLLATE Latin1_General_BIN NOT NULL,&#xA;&#x9;[KA2462_VERWOGEN] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_GEW_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_V_TW_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_V_TH_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_KEIN_GEW] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_NEBENPRODUKT] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_USER] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_STATION] [smallint] NOT NULL,&#xA;&#x9;[KA2462_START_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_START_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_ENDE_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ENDE_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_LAGERPREIS] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_WAEHRUNG] [nchar](4) COLLATE Latin1_General_BIN NOT NULL,&#xA;&#x9;[KA2462_REZ_STUFE] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_REZ_STUFE_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_BUCHUNGSART] [tinyint] not null,&#xA;&#x9;[KA2462_ANL_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ANL_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_UPD_ZEIT] [int] NOT NULL) end&#xA;SELECT * INTO #temp_DWH_KA2462_SSIS FROM &#xA;&#x9;(SELECT [KA2462_CHAR_NR],[KA2462_CHAR_POSTEN_NR],[KA2462_UNIQUE_NR]&#xA;    ,[KA2462_ART_NR],[KA2462_ART_POS_LFD_NR],[KA2462_SPLITPOSTEN]&#xA;    ,[KA2462_SPLIT_QUELLPOSTEN_NR],[KA2462_SOLLMENGE_LE_EK]&#xA;    ,[KA2462_SOLLMENGE_PE_EK],[KA2462_ISTMENGE_LE_EK],[KA2462_ISTMENGE_PE_EK]&#xA;    ,[KA2462_ANT_AN_GES_MENGE],[KA2462_ABG_KST_NR]&#xA;    ,[KA2462_ABG_LT_NR],[KA2462_ABG_LT_DATUM],[KA2462_ABG_LT_LOS]&#xA;&#x9;,[KA2462_VERWOGEN],[KA2462_GEW_TYP]&#xA;&#x9;,[KA2462_V_TW_TYP],[KA2462_V_TH_TYP]&#xA;&#x9;,[KA2462_KEIN_GEW],[KA2462_NEBENPRODUKT]&#xA;    ,[KA2462_VERW_UPD_DATUM],[KA2462_VERW_UPD_ZEIT],[KA2462_VERW_UPD_USER],[KA2462_VERW_UPD_STATION]&#xA;    ,[KA2462_START_DATUM],[KA2462_START_ZEIT],[KA2462_ENDE_DATUM],[KA2462_ENDE_ZEIT]&#xA;    ,[KA2462_LAGERPREIS],[KA2462_WAEHRUNG],[KA2462_REZ_STUFE],[KA2462_REZ_STUFE_LFD_NR],[KA2462_BUCHUNGSART]&#xA;    ,[KA2462_ANL_DATUM],[KA2462_ANL_ZEIT],[KA2462_UPD_DATUM],[KA2462_UPD_ZEIT] FROM [CSB].[dbo].[ka2462_00104] with(nolock) where KA2462_UPD_DATUM &gt;= @yesterday_date) as sub_KA2462&#xA;  where dbo.Convert_CSB_Date_Time(KA2462_UPD_DATUM, KA2462_UPD_ZEIT) &gt;= @yesterday&#xA;&#xA;&#xA;&#xA;&#x9;&#xA;&#xA;UPDATE temp_DWH_KA2462_SSIS with (updlock,serializable)&#xA;   SET [KA2462_CHAR_NR] = tab3.KA2462_CHAR_NR&#xA;      ,[KA2462_CHAR_POSTEN_NR] = tab3.KA2462_CHAR_POSTEN_NR&#xA;      ,[KA2462_UNIQUE_NR] = tab3.KA2462_UNIQUE_NR&#xA;      ,[KA2462_ART_NR] = tab3.KA2462_ART_NR&#xA;      ,[KA2462_ART_POS_LFD_NR] = tab3.KA2462_ART_POS_LFD_NR&#xA;      ,[KA2462_SPLITPOSTEN] = tab3.KA2462_SPLITPOSTEN&#xA;      ,[KA2462_SPLIT_QUELLPOSTEN_NR] = tab3.KA2462_SPLIT_QUELLPOSTEN_NR&#xA;      ,[KA2462_SOLLMENGE_LE_EK] = tab3.KA2462_SOLLMENGE_LE_EK&#xA;      ,[KA2462_SOLLMENGE_PE_EK] = tab3.KA2462_SOLLMENGE_PE_EK&#xA;      ,[KA2462_ISTMENGE_LE_EK] = tab3.KA2462_ISTMENGE_LE_EK&#xA;      ,[KA2462_ISTMENGE_PE_EK] = tab3.KA2462_ISTMENGE_PE_EK&#xA;      ,[KA2462_ANT_AN_GES_MENGE] = tab3.KA2462_ANT_AN_GES_MENGE&#xA;      ,[KA2462_ABG_KST_NR] = tab3.KA2462_ABG_KST_NR&#xA;      ,[KA2462_ABG_LT_NR] = tab3.KA2462_ABG_LT_NR&#xA;      ,[KA2462_ABG_LT_DATUM] = tab3.KA2462_ABG_LT_DATUM&#xA;      ,[KA2462_ABG_LT_LOS] = tab3.KA2462_ABG_LT_LOS&#xA;&#x9;  ,[KA2462_VERWOGEN] = tab3.KA2462_VERWOGEN&#xA;&#x9;  ,[KA2462_GEW_TYP] = tab3.KA2462_GEW_TYP&#xA;&#x9;  ,[KA2462_V_TW_TYP] = tab3.KA2462_V_TW_TYP&#xA;&#x9;  ,[KA2462_V_TH_TYP] = tab3.KA2462_V_TH_TYP&#xA;&#x9;  ,[KA2462_KEIN_GEW] = tab3.KA2462_KEIN_GEW&#xA;&#x9;  ,[KA2462_NEBENPRODUKT] = tab3.KA2462_NEBENPRODUKT&#xA;      ,[KA2462_VERW_UPD_DATUM] = tab3.KA2462_VERW_UPD_DATUM&#xA;      ,[KA2462_VERW_UPD_ZEIT] = tab3.KA2462_VERW_UPD_ZEIT&#xA;      ,[KA2462_VERW_UPD_USER] = tab3.KA2462_VERW_UPD_USER&#xA;      ,[KA2462_VERW_UPD_STATION] = tab3.KA2462_VERW_UPD_STATION&#xA;      ,[KA2462_START_DATUM] = tab3.KA2462_START_DATUM&#xA;      ,[KA2462_START_ZEIT] = tab3.KA2462_START_ZEIT&#xA;      ,[KA2462_ENDE_DATUM] = tab3.KA2462_ENDE_DATUM&#xA;      ,[KA2462_ENDE_ZEIT] = tab3.KA2462_ENDE_ZEIT&#xA;      ,[KA2462_LAGERPREIS] = tab3.KA2462_LAGERPREIS&#xA;      ,[KA2462_WAEHRUNG] = tab3.KA2462_WAEHRUNG&#xA;      ,[KA2462_REZ_STUFE] = tab3.KA2462_REZ_STUFE&#xA;      ,[KA2462_REZ_STUFE_LFD_NR] = tab3.KA2462_REZ_STUFE_LFD_NR&#xA;&#x9;  ,[KA2462_BUCHUNGSART] = tab3.[KA2462_BUCHUNGSART]&#xA;      ,[KA2462_ANL_DATUM] = tab3.KA2462_ANL_DATUM&#xA;      ,[KA2462_ANL_ZEIT] = tab3.KA2462_ANL_ZEIT&#xA;      ,[KA2462_UPD_DATUM] = tab3.KA2462_UPD_DATUM&#xA;      ,[KA2462_UPD_ZEIT] = tab3.KA2462_UPD_ZEIT&#xA;&#x9;FROM temp_DWH_KA2462_SSIS inner join #temp_DWH_KA2462_SSIS tab3 on temp_DWH_KA2462_SSIS.KA2462_CHAR_NR = tab3.KA2462_CHAR_NR and temp_DWH_KA2462_SSIS.KA2462_CHAR_POSTEN_NR = tab3.KA2462_CHAR_POSTEN_NR&#x9;&#x9;&#x9;&#xA;INSERT temp_DWH_KA2462_SSIS select * from dbo.#temp_DWH_KA2462_SSIS tab3&#xA;&#x9;where not exists (select KA2462_CHAR_NR, KA2462_CHAR_POSTEN_NR from temp_DWH_KA2462_SSIS where KA2462_CHAR_NR = tab3.KA2462_CHAR_NR &#xA;&#x9;&#x9;and temp_DWH_KA2462_SSIS.KA2462_CHAR_POSTEN_NR = tab3.KA2462_CHAR_POSTEN_NR)&#xA;&#xA;&#x9;delete temp_DWH_KA2462_SSIS&#x9;&#x9;&#x9;where dbo.Convert_CSB_Date_Time(KA2462_UPD_DATUM, KA2462_UPD_ZEIT) &lt;= @yesterday&#xA;&#x9;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_csb_to_temp_csb6500"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{02d4f8cf-8be0-4c79-aae7-fd4a9fa4e0b2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_csb_to_temp_csb6500"
      DTS:ThreadHint="3">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="declare @nowdate datetime = GETDATE() ,@yesterday datetime = DATEADD(DAY,-2,GETDATE())&#xA;&#x9;declare @yesterday_date int = convert(nchar(8),dateadd(DAY,-2,getdate()),112)&#xA;&#xA;&#xA;&#x9;IF OBJECT_ID(N'tempdb..#temp_DWH_KA6500_SSIS', N'U') is not null BEGIN drop table dbo.#temp_DWH_KA6500_SSIS END&#xA;&#x9;--IF OBJECT_ID(N'tempdb..#temp_DWH_KA2438_2439', N'U') is not null BEGIN drop table dbo.#temp_DWH_KA2438_2439 END&#xA;&#xA;IF OBJECT_ID(N'temp_DWH_KA6500_SSIS', N'U') is null BEGIN create table dbo.temp_DWH_KA6500_SSIS(&#xA;&#x9;[KA6500_CHARGEN_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA6500_LFD_NR_2] [smallint] NOT NULL,&#xA;&#x9;[KA6500_REC_NR] [int] NOT NULL,&#xA;&#x9;[KA6500_PERIODE] [int] NOT NULL,&#xA;&#x9;[KA6500_RELEASE] [smallint] NOT NULL,&#xA;&#x9;[KA6500_TYP_KZ] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_STORNO_KZ] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_REF_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_NVE_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_HISTORISCH] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LAGERPLATZ] [bigint] NOT NULL,&#xA;&#x9;[KA6500_UEBERNAHME] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_LE] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_PE] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_TARA] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_WERT] [decimal](18, 5) NOT NULL,&#xA;&#x9;[KA6500_LB_SUM_VAR] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LB_BEW_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_ANL_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_ANL_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA6500_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_UPD_ZEIT] [int] NOT NULL)&#xA; END&#xA;SELECT * &#xA;INTO #temp_DWH_KA6500_SSIS &#xA;FROM &#xA;&#x9;(SELECT [KA6500_CHARGEN_NR],[KA6500_LFD_NR],[KA6500_LFD_NR_2]&#xA;&#x9;&#x9;  ,[KA6500_REC_NR],[KA6500_PERIODE]&#xA;&#x9;&#x9;  ,[KA6500_RELEASE],[KA6500_TYP_KZ],[KA6500_STORNO_KZ]&#xA;&#x9;&#x9;  ,[KA6500_REF_NR],[KA6500_NVE_NR]&#xA;&#x9;&#x9;  ,[KA6500_HISTORISCH],[KA6500_LAGERPLATZ],[KA6500_UEBERNAHME]&#xA;&#x9;&#x9;  ,[KA6500_LB_MENGE_LE],[KA6500_LB_MENGE_PE],[KA6500_LB_MENGE_TARA]&#xA;&#x9;&#x9;  ,[KA6500_LB_WERT],[KA6500_LB_SUM_VAR],[KA6500_LB_BEW_DATUM]&#xA;&#x9;&#x9;  ,[KA6500_ANL_DATUM],[KA6500_ANL_ZEIT],[KA6500_UPD_DATUM],[KA6500_UPD_ZEIT]&#xA;&#x9;  FROM [CSB].[dbo].[ka6500_00101] with(nolock) where [KA6500_UPD_DATUM] &gt;= @yesterday_date) as sub_KA6500&#xA;WHERE dbo.Convert_CSB_Date_Time([KA6500_UPD_DATUM], [KA6500_UPD_ZEIT]) &gt;= @yesterday&#xA;&#xA;UPDATE temp_DWH_KA6500_SSIS with (updlock,serializable)&#xA;   SET [KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR]&#xA;      ,[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR]&#xA;      ,[KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2]&#xA;      ,[KA6500_REC_NR] = tab4.[KA6500_REC_NR]&#xA;      ,[KA6500_PERIODE] = tab4.[KA6500_PERIODE]&#xA;      ,[KA6500_RELEASE] = tab4.[KA6500_RELEASE]&#xA;&#x9;  ,[KA6500_TYP_KZ] = tab4.[KA6500_TYP_KZ]&#xA;&#x9;  ,[KA6500_STORNO_KZ] = tab4.[KA6500_STORNO_KZ]&#xA;&#x9;  ,[KA6500_REF_NR] = tab4.[KA6500_REF_NR]&#xA;      ,[KA6500_NVE_NR] = tab4.[KA6500_NVE_NR]&#xA;      ,[KA6500_HISTORISCH] = tab4.[KA6500_HISTORISCH]&#xA;      ,[KA6500_LAGERPLATZ] = tab4.[KA6500_LAGERPLATZ]&#xA;      ,[KA6500_UEBERNAHME] = tab4.[KA6500_UEBERNAHME]&#xA;      ,[KA6500_LB_MENGE_LE] = tab4.[KA6500_LB_MENGE_LE]&#xA;      ,[KA6500_LB_MENGE_PE] = tab4.[KA6500_LB_MENGE_PE]&#xA;      ,[KA6500_LB_MENGE_TARA] = tab4.[KA6500_LB_MENGE_TARA]&#xA;      ,[KA6500_LB_WERT] = tab4.[KA6500_LB_WERT]&#xA;      ,[KA6500_LB_SUM_VAR] = tab4.[KA6500_LB_SUM_VAR]&#xA;      ,[KA6500_LB_BEW_DATUM] = tab4.[KA6500_LB_BEW_DATUM]&#xA;      ,[KA6500_ANL_DATUM] = tab4.[KA6500_ANL_DATUM]&#xA;      ,[KA6500_ANL_ZEIT] = tab4.[KA6500_ANL_ZEIT]&#xA;      ,[KA6500_UPD_DATUM] = tab4.[KA6500_UPD_DATUM]&#xA;      ,[KA6500_UPD_ZEIT] = tab4.[KA6500_UPD_ZEIT]&#xA;&#x9;FROM temp_DWH_KA6500_SSIS inner join #temp_DWH_KA6500_SSIS tab4 on temp_DWH_KA6500_SSIS.[KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR] and temp_DWH_KA6500_SSIS.[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR] AND temp_DWH_KA6500_SSIS.[KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2]&#x9;&#x9;&#x9;&#xA;INSERT temp_DWH_KA6500_SSIS select * from dbo.#temp_DWH_KA6500_SSIS tab4&#xA;&#x9;where not exists (select [KA6500_CHARGEN_NR],[KA6500_LFD_NR],[KA6500_LFD_NR_2] from temp_DWH_KA6500_SSIS where [KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR] &#xA;&#x9;&#x9;and temp_DWH_KA6500_SSIS.[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR] AND [KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2])&#xA;&#xA;&#xA;&#x9;delete temp_DWH_KA6500_SSIS&#x9;&#x9;&#x9;where dbo.Convert_CSB_Date_Time(KA6500_UPD_DATUM, KA6500_UPD_ZEIT) &lt;= @yesterday" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_temp_csb_to_dwh2462"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5851f9ba-646a-4d16-b173-0dcf13f8eab1}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_temp_csb_to_dwh2462"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="&#xA;IF object_id(N'tempdb..#cp_DWH_KA2462_SSIS', N'U') is not null drop table dbo.#cp_DWH_KA2462_SSIS&#xA;&#xA;IF OBJECT_ID(N'cp_DWH_KA2462_SSIS', N'U') is null BEGIN create table dbo.cp_DWH_KA2462_SSIS(&#xA;&#x9;[KA2462_CHAR_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_CHAR_POSTEN_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_UNIQUE_NR] [int] NOT NULL,&#xA;&#x9;[KA2462_ART_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ART_POS_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_SPLITPOSTEN] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_SPLIT_QUELLPOSTEN_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_SOLLMENGE_LE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_SOLLMENGE_PE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ISTMENGE_LE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ISTMENGE_PE_EK] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_ANT_AN_GES_MENGE] [float] NOT NULL,&#xA;&#x9;[KA2462_ABG_KST_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_NR] [bigint] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ABG_LT_LOS] [nchar](20) COLLATE Latin1_General_BIN NOT NULL,&#xA;&#x9;[KA2462_VERWOGEN] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_GEW_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_V_TW_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_V_TH_TYP] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_KEIN_GEW] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_NEBENPRODUKT] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_USER] [int] NOT NULL,&#xA;&#x9;[KA2462_VERW_UPD_STATION] [smallint] NOT NULL,&#xA;&#x9;[KA2462_START_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_START_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_ENDE_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ENDE_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_LAGERPREIS] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA2462_WAEHRUNG] [nchar](4) COLLATE Latin1_General_BIN NOT NULL,&#xA;&#x9;[KA2462_REZ_STUFE] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_REZ_STUFE_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA2462_BUCHUNGSART] [tinyint] NOT NULL,&#xA;&#x9;[KA2462_ANL_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_ANL_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA2462_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA2462_UPD_ZEIT] [int] NOT NULL, ) END&#xA;SELECT * INTO #cp_DWH_KA2462_SSIS from [11-VM-CSBSQL].[CSB].[dbo].[temp_DWH_KA2462_SSIS]&#xA;UPDATE cp_DWH_KA2462_SSIS with (updlock,serializable)&#xA;   SET [KA2462_CHAR_NR] = tab3.KA2462_CHAR_NR&#xA;      ,[KA2462_CHAR_POSTEN_NR] = tab3.KA2462_CHAR_POSTEN_NR&#xA;      ,[KA2462_UNIQUE_NR] = tab3.KA2462_UNIQUE_NR&#xA;      ,[KA2462_ART_NR] = tab3.KA2462_ART_NR&#xA;      ,[KA2462_ART_POS_LFD_NR] = tab3.KA2462_ART_POS_LFD_NR&#xA;      ,[KA2462_SPLITPOSTEN] = tab3.KA2462_SPLITPOSTEN&#xA;      ,[KA2462_SPLIT_QUELLPOSTEN_NR] = tab3.KA2462_SPLIT_QUELLPOSTEN_NR&#xA;      ,[KA2462_SOLLMENGE_LE_EK] = tab3.KA2462_SOLLMENGE_LE_EK&#xA;      ,[KA2462_SOLLMENGE_PE_EK] = tab3.KA2462_SOLLMENGE_PE_EK&#xA;      ,[KA2462_ISTMENGE_LE_EK] = tab3.KA2462_ISTMENGE_LE_EK&#xA;      ,[KA2462_ISTMENGE_PE_EK] = tab3.KA2462_ISTMENGE_PE_EK&#xA;      ,[KA2462_ANT_AN_GES_MENGE] = tab3.KA2462_ANT_AN_GES_MENGE&#xA;      ,[KA2462_ABG_KST_NR] = tab3.KA2462_ABG_KST_NR&#xA;      ,[KA2462_ABG_LT_NR] = tab3.KA2462_ABG_LT_NR&#xA;      ,[KA2462_ABG_LT_DATUM] = tab3.KA2462_ABG_LT_DATUM&#xA;      ,[KA2462_ABG_LT_LOS] = tab3.KA2462_ABG_LT_LOS&#xA;&#x9;  ,[KA2462_VERWOGEN] = tab3.KA2462_VERWOGEN&#xA;&#x9;  ,[KA2462_GEW_TYP] = tab3.KA2462_GEW_TYP&#xA;&#x9;  ,[KA2462_V_TW_TYP] = tab3.KA2462_V_TW_TYP&#xA;&#x9;  ,[KA2462_V_TH_TYP] = tab3.KA2462_V_TH_TYP&#xA;&#x9;  ,[KA2462_KEIN_GEW] = tab3.KA2462_KEIN_GEW&#xA;&#x9;  ,[KA2462_NEBENPRODUKT] = tab3.KA2462_NEBENPRODUKT&#xA;      ,[KA2462_VERW_UPD_DATUM] = tab3.KA2462_VERW_UPD_DATUM&#xA;      ,[KA2462_VERW_UPD_ZEIT] = tab3.KA2462_VERW_UPD_ZEIT&#xA;      ,[KA2462_VERW_UPD_USER] = tab3.KA2462_VERW_UPD_USER&#xA;      ,[KA2462_VERW_UPD_STATION] = tab3.KA2462_VERW_UPD_STATION&#xA;      ,[KA2462_START_DATUM] = tab3.KA2462_START_DATUM&#xA;      ,[KA2462_START_ZEIT] = tab3.KA2462_START_ZEIT&#xA;      ,[KA2462_ENDE_DATUM] = tab3.KA2462_ENDE_DATUM&#xA;      ,[KA2462_ENDE_ZEIT] = tab3.KA2462_ENDE_ZEIT&#xA;      ,[KA2462_LAGERPREIS] = tab3.KA2462_LAGERPREIS&#xA;      ,[KA2462_WAEHRUNG] = tab3.KA2462_WAEHRUNG&#xA;      ,[KA2462_REZ_STUFE] = tab3.KA2462_REZ_STUFE&#xA;      ,[KA2462_REZ_STUFE_LFD_NR] = tab3.KA2462_REZ_STUFE_LFD_NR&#xA;&#x9;  ,[KA2462_BUCHUNGSART] = tab3.KA2462_BUCHUNGSART&#xA;      ,[KA2462_ANL_DATUM] = tab3.KA2462_ANL_DATUM&#xA;      ,[KA2462_ANL_ZEIT] = tab3.KA2462_ANL_ZEIT&#xA;      ,[KA2462_UPD_DATUM] = tab3.KA2462_UPD_DATUM&#xA;      ,[KA2462_UPD_ZEIT] = tab3.KA2462_UPD_ZEIT&#xA;&#x9;  &#x9;FROM cp_DWH_KA2462_SSIS inner join #cp_DWH_KA2462_SSIS tab3 on cp_DWH_KA2462_SSIS.KA2462_CHAR_NR = tab3.KA2462_CHAR_NR and cp_DWH_KA2462_SSIS.KA2462_CHAR_POSTEN_NR = tab3.KA2462_CHAR_POSTEN_NR&#x9;&#x9;&#x9;&#xA;INSERT cp_DWH_KA2462_SSIS select * from #cp_DWH_KA2462_SSIS tab3&#xA;&#x9;where not exists (select KA2462_CHAR_NR, KA2462_CHAR_POSTEN_NR from cp_DWH_KA2462_SSIS where KA2462_CHAR_NR = tab3.KA2462_CHAR_NR &#xA;&#x9;&#x9;and KA2462_CHAR_POSTEN_NR = tab3.KA2462_CHAR_POSTEN_NR)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_temp_csb_to_dwh52"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2ee84fda-af3a-47e1-862d-b0b611659c3a}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_temp_csb_to_dwh52"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\insert_from_temp_csb_to_dwh52.EventHandlers[OnError]"
          DTS:CreationName="OnError"
          DTS:DTSID="{67A2713F-FF2E-4D74-8A33-A9ADD0CC44AC}"
          DTS:EventID="-2147287018"
          DTS:EventName="OnError"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{C308141B-3499-4E3D-A2E2-DA71EF8B43DF}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables />
        </DTS:EventHandler>
      </DTS:EventHandlers>
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="11111111&#xA;SET NOCOUNT ON;&#xA;&#x9;SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xA;&#x9;DECLARE @current_mounth char(6) = left(convert(char(8),getdate(),112),6), @previous_month nchar(6) = left(convert(nchar(8),DATEADD(month,-1,getdate()),112),6)&#xA;&#x9;,@current_DWH_LA0052 varchar(max), @previous_DWH_LA0052 varchar(max), @insert_from_CSB varchar(max),@create_DWH_LA0052 varchar(max)&#xA;&#x9;,@create_cp_DWH_LA0052 varchar(max), @insert_cp_DWH_LA0052 varchar(max), @cp_DWH_LA0052 varchar(50) = '#cp_DWH_LA0052_SSIS'&#xA;&#xA;&#x9;IF object_id(N'tempdb..#cp_DWH_LA0052_SSIS', N'U') is not null drop table dbo.#cp_DWH_LA0052_SSIS;&#xA;&#x9;IF OBJECT_ID(N'tempdb..#cp_DWH_LA0052_SSIS', N'U') IS NULL BEGIN create table #cp_DWH_LA0052_SSIS &#xA;&#x9;&#x9;&#x9;(L52_REC_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_DATE_MOVE datetime not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_ART_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BW_TYP tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_1 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_2 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_ME decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_PREIS decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_IST decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_SOLL decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_KORREKTUR tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG bigint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG_SUB_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_SUB_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BUCHUNGS_TYP smallint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_IST decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_SOLL decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_BELEG_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_FOLGESATZ_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ADR_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ANBRUCH_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_GND_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_VATER_PROG smallint not null&#xA;&#x9;&#x9;&#x9;,L52_TEILENTNAHME_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTRB_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTV_TARA decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_STORNO_POSTEN tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_MERP_TICKET bigint not null&#xA;&#x9;&#x9;&#x9;,L52_PROCESS_ID bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE_AKTION tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_ART_WECHSEL tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_FIFO_BUCHUNG tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_BEWEGUNGS_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_ZEIT int not null&#xA;&#x9;&#x9;&#x9;,L52_USER int not null&#xA;&#x9;&#x9;&#x9;,L52_STATION smallint not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_STATION int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_ZEIT int not null) end&#xA;&#xA;&#x9;set @create_DWH_LA0052 = 'IF OBJECT_ID(N''[dbo].cp_DWH_LA0052_SSIS_'+@current_mounth+''', N''U'') IS NULL BEGIN create table [dbo].[cp_DWH_LA0052_SSIS_'+@current_mounth+'] &#xA;&#x9;&#x9;&#x9;(L52_REC_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_DATE_MOVE datetime not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_ART_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BW_TYP tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_1 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_NR_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_2 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_ME decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_PREIS decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_IST decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_SOLL decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_KORREKTUR tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG bigint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG_SUB_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_SUB_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BUCHUNGS_TYP smallint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_IST decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_SOLL decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_BELEG_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_FOLGESATZ_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ADR_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ANBRUCH_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_GND_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_VATER_PROG smallint not null&#xA;&#x9;&#x9;&#x9;,L52_TEILENTNAHME_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTRB_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTV_TARA decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_STORNO_POSTEN tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNIERTE_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_REC_NR bigint NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_STORNO_PERIODE int NOT NULL&#xA;&#x9;&#x9;&#x9;,L52_MERP_TICKET bigint not null&#xA;&#x9;&#x9;&#x9;,L52_PROCESS_ID bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE_AKTION tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_ART_WECHSEL tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_FIFO_BUCHUNG tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_BEWEGUNGS_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_ZEIT int not null&#xA;&#x9;&#x9;&#x9;,L52_USER int not null&#xA;&#x9;&#x9;&#x9;,L52_STATION smallint not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_STATION int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_ZEIT int not null,  CONSTRAINT [cp_DWH_LA0052_SSIS_'+@current_mounth+'_PK] PRIMARY KEY CLUSTERED &#xA;(&#xA;&#x9;[L52_REC_NR] ASC&#xA;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY],&#xA; CONSTRAINT [cp_DWH_LA0052_SSIS_'+@current_mounth+'_SK_K1] UNIQUE NONCLUSTERED &#xA;(&#xA;&#x9;[L52_STATION] ASC,&#xA;&#x9;[L52_REC_NR] ASC&#xA;)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]&#xA;) ON [PRIMARY] end'&#xA;&#xA;/*set @create_temp_DWH_LA0052 = ' &#xA;&#x9;IF OBJECT_ID(N''tempdb..'+@temp_DWH_LA0052+''', N''U'') IS NULL BEGIN create table ['+@temp_DWH_LA0052+'] &#xA;&#x9;&#x9;&#x9;(L52_REC_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_DATE_MOVE datetime not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_KONTO_ID_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_ART_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BW_TYP tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_1 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_1 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_1 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_KST_NR_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_DATUM_2 int not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERTYP_LOS_2 nchar(20) not null&#xA;&#x9;&#x9;&#x9;,L52_LAGERPLATZ_2 bigint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_ME decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_PREIS decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_IST decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_SOLL decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_KORREKTUR tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG bigint not null&#xA;&#x9;&#x9;&#x9;,L52_AUFTRAG_SUB_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_SUB_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_BUCHUNGS_TYP smallint not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK_LE decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_MENGE_VK decimal(18, 6) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_IST decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_WERT_VK_SOLL decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_BELEG_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_FOLGESATZ_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_POSTEN_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ADR_NR bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ZIEL_OBER_NVE bigint not null&#xA;&#x9;&#x9;&#x9;,L52_ANBRUCH_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_GND_NR int not null&#xA;&#x9;&#x9;&#x9;,L52_VATER_PROG smallint not null&#xA;&#x9;&#x9;&#x9;,L52_TEILENTNAHME_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTRB_KZ tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MTV_TARA decimal(18, 5) not null&#xA;&#x9;&#x9;&#x9;,L52_STORNO_POSTEN tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_MERP_TICKET bigint not null&#xA;&#x9;&#x9;&#x9;,L52_PROCESS_ID bigint not null&#xA;&#x9;&#x9;&#x9;,L52_NVE_AKTION tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_ART_WECHSEL tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_FIFO_BUCHUNG tinyint not null&#xA;&#x9;&#x9;&#x9;,L52_BEWEGUNGS_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_ZEIT int not null&#xA;&#x9;&#x9;&#x9;,L52_USER int not null&#xA;&#x9;&#x9;&#x9;,L52_STATION smallint not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_STATION int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_DATUM int not null&#xA;&#x9;&#x9;&#x9;,L52_UPD_ZEIT int not null) end&#xA;&#x9;&#x9;&#x9;,datetimefromparts(L52_BEWEGUNGS_DATUM / 10000, L52_BEWEGUNGS_DATUM / 100 % 100, L52_BEWEGUNGS_DATUM % 100,00 + L52_ZEIT /10000,00+L52_ZEIT/100%100,00+L52_ZEIT % 100,0000) as L52_DATE_MOVE'*/&#xA;set @insert_cp_DWH_LA0052 = '&#xA;&#x9;INSERT #cp_DWH_LA0052_SSIS&#xA;&#x9;SELECT L52_REC_NR,datetimefromparts(L52_BEWEGUNGS_DATUM / 10000, L52_BEWEGUNGS_DATUM / 100 % 100, L52_BEWEGUNGS_DATUM % 100,00 + L52_ZEIT /10000,00+L52_ZEIT/100%100,00+L52_ZEIT % 100,0000) as L52_DATE_MOVE&#xA;&#x9;&#x9;,L52_KONTO_ID_1,L52_KONTO_ID_2,L52_ART_NR,L52_BW_TYP,L52_KST_NR_1,L52_LAGERTYP_NR_1,L52_LAGERTYP_DATUM_1,L52_LAGERTYP_LOS_1,L52_LAGERPLATZ_1,L52_KST_NR_2,L52_LAGERTYP_NR_2,L52_LAGERTYP_DATUM_2,L52_LAGERTYP_LOS_2,L52_LAGERPLATZ_2&#xA;&#x9;&#x9;,L52_MENGE_LE,L52_MENGE_ME,L52_PREIS,L52_WERT_IST,L52_WERT_SOLL,L52_KORREKTUR,L52_AUFTRAG,L52_AUFTRAG_SUB_NR,L52_SUB_POSTEN_NR,L52_BUCHUNGS_TYP,L52_MENGE_VK_LE,L52_MENGE_VK,L52_WERT_VK_IST,L52_WERT_VK_SOLL&#xA;&#x9;&#x9;,L52_BELEG_DATUM,L52_FOLGESATZ_KZ,L52_POSTEN_NR,L52_ADR_NR,L52_NVE,L52_OBER_NVE,L52_ZIEL_NVE,L52_ZIEL_OBER_NVE,L52_ANBRUCH_KZ,L52_GND_NR,L52_VATER_PROG,L52_TEILENTNAHME_KZ,L52_MTRB_KZ,L52_MTV_TARA&#xA;&#x9;&#x9;,L52_STORNO_POSTEN,L52_STORNIERTE_REC_NR,L52_STORNIERTE_PERIODE,L52_STORNO_REC_NR,L52_STORNO_PERIODE,L52_MERP_TICKET,L52_PROCESS_ID,L52_NVE_AKTION,L52_ART_WECHSEL,L52_FIFO_BUCHUNG,L52_BEWEGUNGS_DATUM,L52_ZEIT,L52_USER,L52_STATION,L52_UPD_STATION,L52_UPD_DATUM,L52_UPD_ZEIT &#xA;&#x9;FROM [11-VM-CSBSQL].[CSB].[dbo].[temp_DWH_LA0052_SSIS]'&#xA;exec (@create_DWH_LA0052 + @insert_cp_DWH_LA0052)&#xA;set @current_DWH_LA0052 = '&#xA;&#x9;update tab1 with (updlock,serializable)&#xA;&#x9;&#x9;&#x9;set tab1.L52_REC_NR&#x9;&#x9;&#x9;= tab2.L52_REC_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_DATE_MOVE&#x9;&#x9;&#x9;= tab2.L52_DATE_MOVE&#xA;&#x9;&#x9;&#x9;,tab1.L52_KONTO_ID_1&#x9;&#x9;= tab2.L52_KONTO_ID_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_KONTO_ID_2&#x9;&#x9;= tab2.L52_KONTO_ID_2&#xA;&#x9;&#x9;&#x9;,tab1.L52_ART_NR&#x9;&#x9;&#x9;= tab2.L52_ART_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_BW_TYP&#x9;&#x9;&#x9;= tab2.L52_BW_TYP&#xA;&#x9;&#x9;&#x9;,tab1.L52_KST_NR_1&#x9;&#x9;&#x9;= tab2.L52_KST_NR_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_NR_1&#x9;&#x9;= tab2.L52_LAGERTYP_NR_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_DATUM_1&#x9;= tab2.L52_LAGERTYP_DATUM_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_LOS_1&#x9;= tab2.L52_LAGERTYP_LOS_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERPLATZ_1&#x9;&#x9;= tab2.L52_LAGERPLATZ_1&#xA;&#x9;&#x9;&#x9;,tab1.L52_KST_NR_2&#x9;&#x9;&#x9;= tab2.L52_KST_NR_2&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_NR_2&#x9;&#x9;= tab2.L52_LAGERTYP_NR_2&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_DATUM_2&#x9;= tab2.L52_LAGERTYP_DATUM_2&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERTYP_LOS_2&#x9;= tab2.L52_LAGERTYP_LOS_2&#xA;&#x9;&#x9;&#x9;,tab1.L52_LAGERPLATZ_2&#x9;&#x9;= tab2.L52_LAGERPLATZ_2&#x9;&#xA;&#x9;&#x9;&#x9;,tab1.L52_MENGE_LE&#x9;&#x9;&#x9;= tab2.L52_MENGE_LE&#xA;&#x9;&#x9;&#x9;,tab1.L52_MENGE_ME&#x9;&#x9;&#x9;= tab2.L52_MENGE_ME&#xA;&#x9;&#x9;&#x9;,tab1.L52_PREIS&#x9;&#x9;&#x9;&#x9;= tab2.L52_PREIS&#xA;&#x9;&#x9;&#x9;,tab1.L52_WERT_IST&#x9;&#x9;&#x9;= tab2.L52_WERT_IST&#xA;&#x9;&#x9;&#x9;,tab1.L52_WERT_SOLL&#x9;&#x9;&#x9;= tab2.L52_WERT_SOLL&#xA;&#x9;&#x9;&#x9;,tab1.L52_KORREKTUR&#x9;&#x9;&#x9;= tab2.L52_KORREKTUR&#xA;&#x9;&#x9;&#x9;,tab1.L52_AUFTRAG&#x9;&#x9;&#x9;= tab2.L52_AUFTRAG&#xA;&#x9;&#x9;&#x9;,tab1.L52_AUFTRAG_SUB_NR&#x9;= tab2.L52_AUFTRAG_SUB_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_SUB_POSTEN_NR&#x9;&#x9;= tab2.L52_SUB_POSTEN_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_BUCHUNGS_TYP&#x9;&#x9;= tab2.L52_BUCHUNGS_TYP&#xA;&#x9;&#x9;&#x9;,tab1.L52_MENGE_VK_LE&#x9;&#x9;= tab2.L52_MENGE_VK_LE&#xA;&#x9;&#x9;&#x9;,tab1.L52_MENGE_VK&#x9;&#x9;&#x9;= tab2.L52_MENGE_VK&#xA;&#x9;&#x9;&#x9;,tab1.L52_WERT_VK_IST&#x9;&#x9;= tab2.L52_WERT_VK_IST&#xA;&#x9;&#x9;&#x9;,tab1.L52_WERT_VK_SOLL&#x9;&#x9;= tab2.L52_WERT_VK_SOLL&#xA;&#x9;&#x9;&#x9;,tab1.L52_BELEG_DATUM&#x9;&#x9;= tab2.L52_BELEG_DATUM&#xA;&#x9;&#x9;&#x9;,tab1.L52_FOLGESATZ_KZ&#x9;&#x9;= tab2.L52_FOLGESATZ_KZ&#xA;&#x9;&#x9;&#x9;,tab1.L52_POSTEN_NR&#x9;&#x9;&#x9;= tab2.L52_POSTEN_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_ADR_NR&#x9;&#x9;&#x9;= tab2.L52_ADR_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_NVE&#x9;&#x9;&#x9;&#x9;= tab2.L52_NVE&#xA;&#x9;&#x9;&#x9;,tab1.L52_OBER_NVE&#x9;&#x9;&#x9;= tab2.L52_OBER_NVE&#xA;&#x9;&#x9;&#x9;,tab1.L52_ZIEL_NVE&#x9;&#x9;&#x9;= tab2.L52_ZIEL_NVE&#xA;&#x9;&#x9;&#x9;,tab1.L52_ZIEL_OBER_NVE&#x9;&#x9;= tab2.L52_ZIEL_OBER_NVE&#xA;&#x9;&#x9;&#x9;,tab1.L52_ANBRUCH_KZ&#x9;&#x9;= tab2.L52_ANBRUCH_KZ&#xA;&#x9;&#x9;&#x9;,tab1.L52_GND_NR&#x9;&#x9;&#x9;= tab2.L52_GND_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_VATER_PROG&#x9;&#x9;= tab2.L52_VATER_PROG&#xA;&#x9;&#x9;&#x9;,tab1.L52_TEILENTNAHME_KZ&#x9;= tab2.L52_TEILENTNAHME_KZ&#xA;&#x9;&#x9;&#x9;,tab1.L52_MTRB_KZ&#x9;&#x9;&#x9;= tab2.L52_MTRB_KZ&#xA;&#x9;&#x9;&#x9;,tab1.L52_MTV_TARA&#x9;&#x9;&#x9;= tab2.L52_MTV_TARA&#xA;&#x9;&#x9;&#x9;,tab1.L52_STORNO_POSTEN&#x9;&#x9;= tab2.L52_STORNO_POSTEN&#xA;&#x9;&#x9;&#x9;,tab1.L52_STORNIERTE_REC_NR&#x9;= tab2.L52_STORNIERTE_REC_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_STORNIERTE_PERIODE = tab2.L52_STORNIERTE_PERIODE&#xA;&#x9;&#x9;&#x9;,tab1.L52_STORNO_REC_NR&#x9;&#x9;= tab2.L52_STORNO_REC_NR&#xA;&#x9;&#x9;&#x9;,tab1.L52_STORNO_PERIODE&#x9;= tab2.L52_STORNO_PERIODE&#xA;&#x9;&#x9;&#x9;,tab1.L52_MERP_TICKET&#x9;&#x9;= tab2.L52_MERP_TICKET&#xA;&#x9;&#x9;&#x9;,tab1.L52_PROCESS_ID&#x9;&#x9;= tab2.L52_PROCESS_ID&#xA;&#x9;&#x9;&#x9;,tab1.L52_NVE_AKTION&#x9;&#x9;= tab2.L52_NVE_AKTION&#xA;&#x9;&#x9;&#x9;,tab1.L52_ART_WECHSEL&#x9;&#x9;= tab2.L52_ART_WECHSEL&#xA;&#x9;&#x9;&#x9;,tab1.L52_FIFO_BUCHUNG&#x9;&#x9;= tab2.L52_FIFO_BUCHUNG&#xA;&#x9;&#x9;&#x9;,tab1.L52_BEWEGUNGS_DATUM&#x9;= tab2.L52_BEWEGUNGS_DATUM&#xA;&#x9;&#x9;&#x9;,tab1.L52_ZEIT&#x9;&#x9;&#x9;&#x9;= tab2.L52_ZEIT&#xA;&#x9;&#x9;&#x9;,tab1.L52_USER&#x9;&#x9;&#x9;&#x9;= tab2.L52_USER&#xA;&#x9;&#x9;&#x9;,tab1.L52_STATION&#x9;&#x9;&#x9;= tab2.L52_STATION&#xA;&#x9;&#x9;&#x9;,tab1.L52_UPD_STATION&#x9;&#x9;= tab2.L52_UPD_STATION&#xA;&#x9;&#x9;&#x9;,tab1.L52_UPD_DATUM&#x9;&#x9;&#x9;= tab2.L52_UPD_DATUM&#xA;&#x9;&#x9;&#x9;,tab1.L52_UPD_ZEIT&#x9;&#x9;&#x9;= tab2.L52_UPD_ZEIT&#xA;&#x9;&#x9;from [dbo].[cp_DWH_LA0052_SSIS_'+@current_mounth+'] tab1&#xA;&#x9;&#x9;&#x9;inner join #cp_DWH_LA0052_SSIS tab2 on tab1.L52_REC_NR = tab2.L52_REC_NR where MONTH(tab2.[L52_DATE_MOVE]) = MONTH(GETDATE())&#xA;&#x9;&#x9;insert [dbo].[cp_DWH_LA0052_SSIS_'+@current_mounth+'] select * from #cp_DWH_LA0052_SSIS tab2&#xA;&#x9;&#x9;&#x9;where not exists (select 1 from [dbo].[cp_DWH_LA0052_SSIS_'+@current_mounth+'] tab1 where tab1.L52_REC_NR = tab2.L52_REC_NR) AND MONTH(tab2.[L52_DATE_MOVE]) = MONTH(GETDATE())'&#xA;&#x9;set @previous_DWH_LA0052 = '&#xA;&#x9;update tab3 &#xA;&#x9;&#x9;&#x9;set tab3.L52_REC_NR&#x9;&#x9;&#x9;= tab4.L52_REC_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_DATE_MOVE&#x9;&#x9;&#x9;= tab4.L52_DATE_MOVE&#xA;&#x9;&#x9;&#x9;,tab3.L52_KONTO_ID_1&#x9;&#x9;= tab4.L52_KONTO_ID_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_KONTO_ID_2&#x9;&#x9;= tab4.L52_KONTO_ID_2&#xA;&#x9;&#x9;&#x9;,tab3.L52_ART_NR&#x9;&#x9;&#x9;= tab4.L52_ART_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_BW_TYP&#x9;&#x9;&#x9;= tab4.L52_BW_TYP&#xA;&#x9;&#x9;&#x9;,tab3.L52_KST_NR_1&#x9;&#x9;&#x9;= tab4.L52_KST_NR_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_NR_1&#x9;&#x9;= tab4.L52_LAGERTYP_NR_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_DATUM_1&#x9;= tab4.L52_LAGERTYP_DATUM_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_LOS_1&#x9;= tab4.L52_LAGERTYP_LOS_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERPLATZ_1&#x9;&#x9;= tab4.L52_LAGERPLATZ_1&#xA;&#x9;&#x9;&#x9;,tab3.L52_KST_NR_2&#x9;&#x9;&#x9;= tab4.L52_KST_NR_2&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_NR_2&#x9;&#x9;= tab4.L52_LAGERTYP_NR_2&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_DATUM_2&#x9;= tab4.L52_LAGERTYP_DATUM_2&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERTYP_LOS_2&#x9;= tab4.L52_LAGERTYP_LOS_2&#xA;&#x9;&#x9;&#x9;,tab3.L52_LAGERPLATZ_2&#x9;&#x9;= tab4.L52_LAGERPLATZ_2&#x9;&#xA;&#x9;&#x9;&#x9;,tab3.L52_MENGE_LE&#x9;&#x9;&#x9;= tab4.L52_MENGE_LE&#xA;&#x9;&#x9;&#x9;,tab3.L52_MENGE_ME&#x9;&#x9;&#x9;= tab4.L52_MENGE_ME&#xA;&#x9;&#x9;&#x9;,tab3.L52_PREIS&#x9;&#x9;&#x9;&#x9;= tab4.L52_PREIS&#xA;&#x9;&#x9;&#x9;,tab3.L52_WERT_IST&#x9;&#x9;&#x9;= tab4.L52_WERT_IST&#xA;&#x9;&#x9;&#x9;,tab3.L52_WERT_SOLL&#x9;&#x9;&#x9;= tab4.L52_WERT_SOLL&#xA;&#x9;&#x9;&#x9;,tab3.L52_KORREKTUR&#x9;&#x9;&#x9;= tab4.L52_KORREKTUR&#xA;&#x9;&#x9;&#x9;,tab3.L52_AUFTRAG&#x9;&#x9;&#x9;= tab4.L52_AUFTRAG&#xA;&#x9;&#x9;&#x9;,tab3.L52_AUFTRAG_SUB_NR&#x9;= tab4.L52_AUFTRAG_SUB_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_SUB_POSTEN_NR&#x9;&#x9;= tab4.L52_SUB_POSTEN_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_BUCHUNGS_TYP&#x9;&#x9;= tab4.L52_BUCHUNGS_TYP&#xA;&#x9;&#x9;&#x9;,tab3.L52_MENGE_VK_LE&#x9;&#x9;= tab4.L52_MENGE_VK_LE&#xA;&#x9;&#x9;&#x9;,tab3.L52_MENGE_VK&#x9;&#x9;&#x9;= tab4.L52_MENGE_VK&#xA;&#x9;&#x9;&#x9;,tab3.L52_WERT_VK_IST&#x9;&#x9;= tab4.L52_WERT_VK_IST&#xA;&#x9;&#x9;&#x9;,tab3.L52_WERT_VK_SOLL&#x9;&#x9;= tab4.L52_WERT_VK_SOLL&#xA;&#x9;&#x9;&#x9;,tab3.L52_BELEG_DATUM&#x9;&#x9;= tab4.L52_BELEG_DATUM&#xA;&#x9;&#x9;&#x9;,tab3.L52_FOLGESATZ_KZ&#x9;&#x9;= tab4.L52_FOLGESATZ_KZ&#xA;&#x9;&#x9;&#x9;,tab3.L52_POSTEN_NR&#x9;&#x9;&#x9;= tab4.L52_POSTEN_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_ADR_NR&#x9;&#x9;&#x9;= tab4.L52_ADR_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_NVE&#x9;&#x9;&#x9;&#x9;= tab4.L52_NVE&#xA;&#x9;&#x9;&#x9;,tab3.L52_OBER_NVE&#x9;&#x9;&#x9;= tab4.L52_OBER_NVE&#xA;&#x9;&#x9;&#x9;,tab3.L52_ZIEL_NVE&#x9;&#x9;&#x9;= tab4.L52_ZIEL_NVE&#xA;&#x9;&#x9;&#x9;,tab3.L52_ZIEL_OBER_NVE&#x9;&#x9;= tab4.L52_ZIEL_OBER_NVE&#xA;&#x9;&#x9;&#x9;,tab3.L52_ANBRUCH_KZ&#x9;&#x9;= tab4.L52_ANBRUCH_KZ&#xA;&#x9;&#x9;&#x9;,tab3.L52_GND_NR&#x9;&#x9;&#x9;= tab4.L52_GND_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_VATER_PROG&#x9;&#x9;= tab4.L52_VATER_PROG&#xA;&#x9;&#x9;&#x9;,tab3.L52_TEILENTNAHME_KZ&#x9;= tab4.L52_TEILENTNAHME_KZ&#xA;&#x9;&#x9;&#x9;,tab3.L52_MTRB_KZ&#x9;&#x9;&#x9;= tab4.L52_MTRB_KZ&#xA;&#x9;&#x9;&#x9;,tab3.L52_MTV_TARA&#x9;&#x9;&#x9;= tab4.L52_MTV_TARA&#xA;&#x9;&#x9;&#x9;,tab3.L52_STORNO_POSTEN&#x9;&#x9;= tab4.L52_STORNO_POSTEN&#xA;&#x9;&#x9;&#x9;,tab3.L52_STORNIERTE_REC_NR&#x9;= tab4.L52_STORNIERTE_REC_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_STORNIERTE_PERIODE= tab4.L52_STORNIERTE_PERIODE&#xA;&#x9;&#x9;&#x9;,tab3.L52_STORNO_REC_NR&#x9;&#x9;= tab4.L52_STORNO_REC_NR&#xA;&#x9;&#x9;&#x9;,tab3.L52_STORNO_PERIODE&#x9;= tab4.L52_STORNO_PERIODE&#xA;&#x9;&#x9;&#x9;,tab3.L52_MERP_TICKET&#x9;&#x9;= tab4.L52_MERP_TICKET&#xA;&#x9;&#x9;&#x9;,tab3.L52_PROCESS_ID&#x9;&#x9;= tab4.L52_PROCESS_ID&#xA;&#x9;&#x9;&#x9;,tab3.L52_NVE_AKTION&#x9;&#x9;= tab4.L52_NVE_AKTION&#xA;&#x9;&#x9;&#x9;,tab3.L52_ART_WECHSEL&#x9;&#x9;= tab4.L52_ART_WECHSEL&#xA;&#x9;&#x9;&#x9;,tab3.L52_FIFO_BUCHUNG&#x9;&#x9;= tab4.L52_FIFO_BUCHUNG&#xA;&#x9;&#x9;&#x9;,tab3.L52_BEWEGUNGS_DATUM&#x9;= tab4.L52_BEWEGUNGS_DATUM&#xA;&#x9;&#x9;&#x9;,tab3.L52_ZEIT&#x9;&#x9;&#x9;&#x9;= tab4.L52_ZEIT&#xA;&#x9;&#x9;&#x9;,tab3.L52_USER&#x9;&#x9;&#x9;&#x9;= tab4.L52_USER&#xA;&#x9;&#x9;&#x9;,tab3.L52_STATION&#x9;&#x9;&#x9;= tab4.L52_STATION&#xA;&#x9;&#x9;&#x9;,tab3.L52_UPD_STATION&#x9;&#x9;= tab4.L52_UPD_STATION&#xA;&#x9;&#x9;&#x9;,tab3.L52_UPD_DATUM&#x9;&#x9;&#x9;= tab4.L52_UPD_DATUM&#xA;&#x9;&#x9;&#x9;,tab3.L52_UPD_ZEIT&#x9;&#x9;&#x9;= tab4.L52_UPD_ZEIT&#xA;&#x9;&#x9;from [dbo].[cp_DWH_LA0052_SSIS_'+@previous_month+'] tab3&#xA;&#x9;&#x9;&#x9;inner join #cp_DWH_LA0052_SSIS tab4 on tab3.L52_REC_NR = tab4.L52_REC_NR where MONTH(tab4.[L52_DATE_MOVE]) = MONTH(DATEADD(month,-1,getdate())) &#xA;&#x9;&#x9;insert [dbo].[cp_DWH_LA0052_SSIS_'+@previous_month+'] select * from #cp_DWH_LA0052_SSIS tab4 &#xA;&#x9;&#x9;&#x9;where not exists (select 1 from [dbo].[cp_DWH_LA0052_SSIS_'+@previous_month+'] tab3 where tab3.L52_REC_NR = tab4.L52_REC_NR) AND MONTH(tab4.[L52_DATE_MOVE]) = MONTH(DATEADD(month,-1,getdate()))'&#xA;&#x9;exec(@current_DWH_LA0052 + @previous_DWH_LA0052)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert_from_temp_csb_to_dwh6500"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4c9a3941-bb8b-4682-baef-07d063820049}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert_from_temp_csb_to_dwh6500"
      DTS:ThreadHint="3">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3FD8FD07-CA07-4901-A194-624194D3CD2F}"
          SQLTask:SqlStatementSource="&#xA;&#x9;IF object_id(N'tempdb..#cp_DWH_KA6500_SSIS', N'U') is not null drop table dbo.#cp_DWH_KA6500_SSIS&#xA;&#xA;&#x9;&#xA;IF OBJECT_ID(N'cp_DWH_KA6500_SSIS', N'U') is null BEGIN create table dbo.cp_DWH_KA6500_SSIS(&#xA;&#x9;[KA6500_CHARGEN_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_LFD_NR] [smallint] NOT NULL,&#xA;&#x9;[KA6500_LFD_NR_2] [smallint] NOT NULL,&#xA;&#x9;[KA6500_REC_NR] [int] NOT NULL,&#xA;&#x9;[KA6500_PERIODE] [int] NOT NULL,&#xA;&#x9;[KA6500_RELEASE] [smallint] NOT NULL,&#xA;&#x9;[KA6500_TYP_KZ] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_STORNO_KZ] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_REF_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_NVE_NR] [bigint] NOT NULL,&#xA;&#x9;[KA6500_HISTORISCH] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LAGERPLATZ] [bigint] NOT NULL,&#xA;&#x9;[KA6500_UEBERNAHME] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_LE] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_PE] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_MENGE_TARA] [decimal](18, 6) NOT NULL,&#xA;&#x9;[KA6500_LB_WERT] [decimal](18, 5) NOT NULL,&#xA;&#x9;[KA6500_LB_SUM_VAR] [tinyint] NOT NULL,&#xA;&#x9;[KA6500_LB_BEW_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_ANL_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_ANL_ZEIT] [int] NOT NULL,&#xA;&#x9;[KA6500_UPD_DATUM] [int] NOT NULL,&#xA;&#x9;[KA6500_UPD_ZEIT] [int] NOT NULL) END&#xA;&#xA;&#xA;&#xA;SELECT * INTO #cp_DWH_KA6500_SSIS from [11-VM-CSBSQL].[CSB].[dbo].[temp_DWH_KA6500_SSIS]&#xA;UPDATE cp_DWH_KA6500_SSIS with (updlock,serializable)&#xA;   SET [KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR]&#xA;      ,[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR]&#xA;      ,[KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2]&#xA;      ,[KA6500_REC_NR] = tab4.[KA6500_REC_NR]&#xA;      ,[KA6500_PERIODE] = tab4.[KA6500_PERIODE]&#xA;      ,[KA6500_RELEASE] = tab4.[KA6500_RELEASE]&#xA;&#x9;  ,[KA6500_TYP_KZ] = tab4.[KA6500_TYP_KZ]&#xA;&#x9;  ,[KA6500_STORNO_KZ] = tab4.[KA6500_STORNO_KZ]&#xA;&#x9;  ,[KA6500_REF_NR] = tab4.[KA6500_REF_NR]&#xA;      ,[KA6500_NVE_NR] = tab4.[KA6500_NVE_NR]&#xA;      ,[KA6500_HISTORISCH] = tab4.[KA6500_HISTORISCH]&#xA;      ,[KA6500_LAGERPLATZ] = tab4.[KA6500_LAGERPLATZ]&#xA;      ,[KA6500_UEBERNAHME] = tab4.[KA6500_UEBERNAHME]&#xA;      ,[KA6500_LB_MENGE_LE] = tab4.[KA6500_LB_MENGE_LE]&#xA;      ,[KA6500_LB_MENGE_PE] = tab4.[KA6500_LB_MENGE_PE]&#xA;      ,[KA6500_LB_MENGE_TARA] = tab4.[KA6500_LB_MENGE_TARA]&#xA;      ,[KA6500_LB_WERT] = tab4.[KA6500_LB_WERT]&#xA;      ,[KA6500_LB_SUM_VAR] = tab4.[KA6500_LB_SUM_VAR]&#xA;      ,[KA6500_LB_BEW_DATUM] = tab4.[KA6500_LB_BEW_DATUM]&#xA;      ,[KA6500_ANL_DATUM] = tab4.[KA6500_ANL_DATUM]&#xA;      ,[KA6500_ANL_ZEIT] = tab4.[KA6500_ANL_ZEIT]&#xA;      ,[KA6500_UPD_DATUM] = tab4.[KA6500_UPD_DATUM]&#xA;      ,[KA6500_UPD_ZEIT] = tab4.[KA6500_UPD_ZEIT]&#xA;FROM cp_DWH_KA6500_SSIS inner join #cp_DWH_KA6500_SSIS tab4 on cp_DWH_KA6500_SSIS.[KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR] and cp_DWH_KA6500_SSIS.[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR] AND cp_DWH_KA6500_SSIS.[KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2]&#x9;&#x9;&#x9;&#xA;INSERT cp_DWH_KA6500_SSIS select * from dbo.#cp_DWH_KA6500_SSIS tab4&#xA;&#x9;WHERE not exists (select [KA6500_CHARGEN_NR],[KA6500_LFD_NR],[KA6500_LFD_NR_2] from cp_DWH_KA6500_SSIS where cp_DWH_KA6500_SSIS.[KA6500_CHARGEN_NR] = tab4.[KA6500_CHARGEN_NR] &#xA;&#x9;&#x9;and cp_DWH_KA6500_SSIS.[KA6500_LFD_NR] = tab4.[KA6500_LFD_NR] AND cp_DWH_KA6500_SSIS.[KA6500_LFD_NR_2] = tab4.[KA6500_LFD_NR_2])&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Script Task"
      DTS:CreationName="Microsoft.ScriptTask"
      DTS:Description="Script Task"
      DTS:DTSID="{a276e02a-3c09-45b7-a9cb-9f88952986e6}"
      DTS:ExecutableType="Microsoft.ScriptTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Script Task"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ScriptProject
          Name="ST_2bfe7c0f6aad45eb908d8990f7c37153"
          VSTAMajorVersion="17"
          VSTAMinorVersion="0"
          Language="CSharp"
          ReadOnlyVariables="User::HasMismatches">
          <ProjectItem
            Name="Properties\Resources.resx"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_026a1c7c5486449196ff52d758647941.Properties.Settings.get_Default():ST_026a1c7c5486449196ff52d758647941.Properties.Sett" +
    "ings")]

namespace ST_026a1c7c5486449196ff52d758647941.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
          <ProjectItem
            Name="ST_2bfe7c0f6aad45eb908d8990f7c37153.csproj"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{f2d11000-81ea-4cea-b74c-f11091944494}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_026a1c7c5486449196ff52d758647941</RootNamespace>
    <AssemblyName>ST_2bfe7c0f6aad45eb908d8990f7c37153</AssemblyName>
    <TargetFrameworkVersion>v4.7</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
    <TargetFrameworkProfile></TargetFrameworkProfile>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=17.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=17.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="ScriptTask" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" DebugInfoCommandLine="" DebugInfoWorkingDir="" IconImageList="" />
        <Host Name="ScriptTask" GeneratedNamespace="$safeprojectname" IconIndex=""></Host>
        <ProjectClient>
          <HostIdentifier>SSIS_ST170</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
          <ProjectItem
            Name="ScriptMain.cs"
            Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.Net.Mail;   // <-- добавлено
using System.Net;       // <-- добавлено
#endregion


namespace ST_026a1c7c5486449196ff52d758647941
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
	public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
	{
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


        /// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
        public void Main()
        {
            try
            {
                // Настройка SMTP-клиента
                using (var client = new SmtpClient("smtp.agrohold.ru"))
                {
                    // Если нужна аутентификация (часто требуется в корпоративных сетях)
                    // client.Credentials = new NetworkCredential("login", "password");
                    // client.EnableSsl = true; // если используется порт 587 или 465

                    var mail = new MailMessage
                    {
                        From = new MailAddress("etl@agrohold.ru"),
                        Subject = "[SSIS] Тест отправки email",
                        Body = "Email успешно отправлен из SSIS Script Task!",
                        IsBodyHtml = false
                    };
                    mail.To.Add("a.d.rogov@agrohold.ru");

                    client.Send(mail);
                }

                // Лог успешной отправки
                bool fireAgain = false;
                Dts.Events.FireInformation(0, "Send Email", "Письмо отправлено успешно", "", 0, ref fireAgain);

                Dts.TaskResult = (int)ScriptResults.Success;
            }
            catch (Exception ex)
            {
                // Лог ошибки
                Dts.Events.FireError(0, "Send Email", "Ошибка отправки: " + ex.Message, "", 0);
                Dts.TaskResult = (int)ScriptResults.Failure;
            }
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

	}
}]]></ProjectItem>
          <ProjectItem
            Name="Project"
            Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="4.0" schemaVersion="1.0">
  <msb:PropertyGroup>
    <msb:CodeName>ST_2bfe7c0f6aad45eb908d8990f7c37153</msb:CodeName>
    <msb:Language>msBuild</msb:Language>
    <msb:DisplayName>ST_2bfe7c0f6aad45eb908d8990f7c37153</msb:DisplayName>
    <msb:ProjectId>{02864676-3195-4511-8CBF-FF41CB5A53B7}</msb:ProjectId>
  </msb:PropertyGroup>
  <msb:ItemGroup>
    <msb:Project Include="ST_2bfe7c0f6aad45eb908d8990f7c37153.csproj" />
    <msb:File Include="Properties\Settings.settings" />
    <msb:File Include="Properties\AssemblyInfo.cs" />
    <msb:File Include="Properties\Resources.resx" />
    <msb:File Include="Properties\Resources.Designer.cs" />
    <msb:File Include="Properties\Settings.Designer.cs" />
    <msb:File Include="ScriptMain.cs" />
  </msb:ItemGroup>
</c:Project>]]></ProjectItem>
          <ProjectItem
            Name="Properties\AssemblyInfo.cs"
            Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_026a1c7c5486449196ff52d758647941")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_026a1c7c5486449196ff52d758647941")]
[assembly: AssemblyCopyright("Copyright @  2025")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.settings"
            Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_026a1c7c5486449196ff52d758647941.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_026a1c7c5486449196ff52d758647941.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_026a1c7c5486449196ff52d758647941.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_026a1c7c5486449196ff52d758647941.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_026a1c7c5486449196ff52d758647941.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
          <BinaryItem
            Name="ST_2bfe7c0f6aad45eb908d8990f7c37153.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAN3VO2kAAAAAAAAAAOAAIiALATAAABIAAAAIAAAAAAAAyjAA
AAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAHgwAABPAAAAAEAAAHgEAAAAAAAAAAAAAAAAAAAA
AAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAA0BAAAAAgAAAAEgAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgEAAAAQAAAAAYAAAAUAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAGAAAAACAAAAGgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAACs
MAAAAAAAAEgAAAACAAUAtCEAAAwOAAABAAAAAAAAAMAvAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAABswBwDRAAAAAQAAEXIBAABwcxAAAAoLcxEAAAolciMAAHBz
EgAACm8TAAAKJXJDAABwbxQAAAolcnkAAHBvFQAACiUWbxYAAAoMCG8XAAAKctMAAHBvGAAACgcI
bxkAAAreCgcsBgdvGgAACtwWCgIoGwAACm8cAAAKFnL/AABwchUBAHBySQEAcBYSAG8dAAAKAigb
AAAKFm8eAAAK3jwNAigbAAAKbxwAAAoWcv8AAHBySwEAcAlvHwAACiggAAAKckkBAHAWbyEAAAom
AigbAAAKF28eAAAK3gAqAAAAARwAAAIACwBMVwAKAAAAAAAAAACUlAA8EQAAAR4CKCIAAAoqHgIo
IwAACiqufgEAAAQtHnJvAQBw0AMAAAIoJAAACm8lAAAKcyYAAAqAAQAABH4BAAAEKhp+AgAABCoe
AoACAAAEKhp+AwAABCoeAignAAAKKi5zCAAABoADAAAEKgAAQlNKQgEAAQAAAAAADAAAAHY0LjAu
MzAzMTkAAAAABQBsAAAAFAQAACN+AACABAAABAYAACNTdHJpbmdzAAAAAIQKAADkAQAAI1VTAGgM
AAAQAAAAI0dVSUQAAAB4DAAAlAEAACNCbG9iAAAAAAAAAAIAAAFXHaIBCQMAAAD6ATMAFgAAAQAA
ACMAAAAFAAAABgAAAAkAAAABAAAAJwAAAAIAAAAQAAAAAQAAAAIAAAADAAAABAAAAAEAAAADAAAA
AQAAAAEAAAAAAIoDAQAAAAAABgA2Ar4EBgDFAr4EBgCCAasEDwAyBQAABgCvAScEBgAZAicEBgD6
AScEBgCsAicEBgBWAicEBgBvAicEBgDGAScEBgDhAekCCgCKAikDCgD5ACkDDgDjBXoDDgCIAHoD
BgBPBMEDBgDRA8EDBgBlAasEBgC1BcEDBgBwBN4EBgBgBBIEDgA1AWQDDgCWAWQDDgAVAf0DBgBK
Ab4EDgCBBXoDDgA5BHoDBgCUAMEDCgBSAykDCgCABCkDBgADA8EDBgDEAMEDBgCgAMEDBgD7BScE
AAAAAEkAAAAAAAEAAQABABAA4gMBADkAAQABAAAAEADlBEEFUQABAAMAAAEQAHAFQQVlAAMABwAD
AQAAlQUAAEkABAAKABEA1gOWABEA6QCaABEAbACeAAYGUgCiAFaAeQWlAFaAyQClAFAgAAAAAIYA
6AMGAAEATCEAAAAAhhieBAYAAQBUIQAAAACDGJ4EBgABAFwhAAAAAJMIbASpAAEAiCEAAAAAkwjR
AK4AAQCPIQAAAACTCN0AswABAJchAAAAAJYIyAW5AAIAniEAAAAAhhieBAYAAgCmIQAAAACRGKQE
vgACAAAAAQDjAgkAngQBABEAngQGABkAngQKACkAngQQADEAngQQADkAngQQAEEAngQQAEkAngQQ
AFEAngQQAFkAngQQAGEAngQQAGkAngQGAJkAngQGAMEAngQVANEAngQGAHkAngQQAIEAngQGANkA
ngQQAIEAyAMlAIEAvAUQAIEA7gUQAIEAsgMrAIEAWQQwAOEAYwAQAHkAZwA1AOkALQEGAHEAjQU7
APEAowVAAPkA7QNFAPEA1AUBAIkAfABQAAEBrgVUAPkAlARaAHEAngQGAKEAngQGAAkBsgBjAAkB
9wVsAKkAngRyAMkAngQGAAgAFACMAAgAGACRACkAcwD5AC4ACwDRAC4AEwDaAC4AGwD5AC4AIwAC
AS4AKwArAS4AMwArAS4AOwArAS4AQwACAS4ASwAxAS4AUwArAS4AWwBIAUMAYwCRAEkAcwD5AGEA
ewCRAGMAawCRABsAAwABAAQAAwAAAHAEwgAAAPEAxwAAAMwFzAACAAQAAwACAAUABQABAAYABQAC
AAcABwAEgAAAAQAAAAUlhlIAAAAAAAAlAAAABAAAAAAAAAAAAAAAegBaAAAAAAARAAAAAAAAAAAA
AACDAAoDAAAAAAQAAAAAAAAAAAAAAHoAwQMAAAAAAAAAAAEAAADvBAAABQACAAAAAFNUXzAyNmEx
YzdjNTQ4NjQ0OTE5NmZmNTJkNzU4NjQ3OTQxAFNUXzJiZmU3YzBmNmFhZDQ1ZWI5MDhkODk5MGY3
YzM3MTUzADxNb2R1bGU+AHZhbHVlX18AbXNjb3JsaWIAQWRkAFNlbmQAZGVmYXVsdEluc3RhbmNl
AGdldF9NZXNzYWdlAE1haWxNZXNzYWdlAElEaXNwb3NhYmxlAFJ1bnRpbWVUeXBlSGFuZGxlAEdl
dFR5cGVGcm9tSGFuZGxlAFR5cGUARmFpbHVyZQBnZXRfQ3VsdHVyZQBzZXRfQ3VsdHVyZQByZXNv
dXJjZUN1bHR1cmUAVlNUQVJUU2NyaXB0T2JqZWN0TW9kZWxCYXNlAEFwcGxpY2F0aW9uU2V0dGlu
Z3NCYXNlAERpc3Bvc2UARWRpdG9yQnJvd3NhYmxlU3RhdGUAQ29tcGlsZXJHZW5lcmF0ZWRBdHRy
aWJ1dGUARGVidWdnZXJOb25Vc2VyQ29kZUF0dHJpYnV0ZQBEZWJ1Z2dhYmxlQXR0cmlidXRlAEVk
aXRvckJyb3dzYWJsZUF0dHJpYnV0ZQBBc3NlbWJseVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJh
ZGVtYXJrQXR0cmlidXRlAFRhcmdldEZyYW1ld29ya0F0dHJpYnV0ZQBBc3NlbWJseUNvbmZpZ3Vy
YXRpb25BdHRyaWJ1dGUAQXNzZW1ibHlEZXNjcmlwdGlvbkF0dHJpYnV0ZQBDb21waWxhdGlvblJl
bGF4YXRpb25zQXR0cmlidXRlAEFzc2VtYmx5UHJvZHVjdEF0dHJpYnV0ZQBBc3NlbWJseUNvcHly
aWdodEF0dHJpYnV0ZQBTU0lTU2NyaXB0VGFza0VudHJ5UG9pbnRBdHRyaWJ1dGUAQXNzZW1ibHlD
b21wYW55QXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAHZhbHVlAFN5c3Rl
bS5SdW50aW1lLlZlcnNpb25pbmcAU3RyaW5nAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuU2NyaXB0VGFz
awBNaWNyb3NvZnQuU3FsU2VydmVyLkR0cy5UYXNrcy5TY3JpcHRUYXNrAFNjcmlwdE9iamVjdE1v
ZGVsAFN5c3RlbS5Db21wb25lbnRNb2RlbABTeXN0ZW0uTmV0Lk1haWwAU1RfMmJmZTdjMGY2YWFk
NDVlYjkwOGQ4OTkwZjdjMzcxNTMuZGxsAHNldF9Jc0JvZHlIdG1sAFN5c3RlbQBzZXRfRnJvbQBF
bnVtAHJlc291cmNlTWFuAFNjcmlwdE1haW4ARmlyZUluZm9ybWF0aW9uAFN5c3RlbS5Db25maWd1
cmF0aW9uAFN5c3RlbS5HbG9iYWxpemF0aW9uAFN5c3RlbS5SZWZsZWN0aW9uAE1haWxBZGRyZXNz
Q29sbGVjdGlvbgBFeGNlcHRpb24AZ2V0X1RvAEN1bHR1cmVJbmZvAGdldF9SZXNvdXJjZU1hbmFn
ZXIARXZlbnRzT2JqZWN0V3JhcHBlcgBGaXJlRXJyb3IALmN0b3IALmNjdG9yAFN5c3RlbS5EaWFn
bm9zdGljcwBTeXN0ZW0uUnVudGltZS5Db21waWxlclNlcnZpY2VzAFN5c3RlbS5SZXNvdXJjZXMA
U1RfMDI2YTFjN2M1NDg2NDQ5MTk2ZmY1MmQ3NTg2NDc5NDEuUHJvcGVydGllcy5SZXNvdXJjZXMu
cmVzb3VyY2VzAERlYnVnZ2luZ01vZGVzAFNUXzAyNmExYzdjNTQ4NjQ0OTE5NmZmNTJkNzU4NjQ3
OTQxLlByb3BlcnRpZXMAU2V0dGluZ3MAU3VjY2VzcwBNYWlsQWRkcmVzcwBnZXRfRHRzAFNjcmlw
dFJlc3VsdHMAZ2V0X0V2ZW50cwBDb25jYXQAT2JqZWN0AHNldF9TdWJqZWN0AGdldF9EZWZhdWx0
AHNldF9UYXNrUmVzdWx0AFNtdHBDbGllbnQAc2V0X0JvZHkAZ2V0X0Fzc2VtYmx5AAAhcwBtAHQA
cAAuAGEAZwByAG8AaABvAGwAZAAuAHIAdQAAH2UAdABsAEAAYQBnAHIAbwBoAG8AbABkAC4AcgB1
AAA1WwBTAFMASQBTAF0AIAAiBDUEQQRCBCAAPgRCBD8EQAQwBDIEOgQ4BCAAZQBtAGEAaQBsAAFZ
RQBtAGEAaQBsACAAQwRBBD8ENQRIBD0EPgQgAD4EQgQ/BEAEMAQyBDsENQQ9BCAAOAQ3BCAAUwBT
AEkAUwAgAFMAYwByAGkAcAB0ACAAVABhAHMAawAhAAErYQAuAGQALgByAG8AZwBvAHYAQABhAGcA
cgBvAGgAbwBsAGQALgByAHUAABVTAGUAbgBkACAARQBtAGEAaQBsAAAzHwQ4BEEETAQ8BD4EIAA+
BEIEPwRABDAEMgQ7BDUEPQQ+BCAAQwRBBD8ENQRIBD0EPgQBAQAjHgRIBDgEMQQ6BDAEIAA+BEIE
PwRABDAEMgQ6BDgEOgAgAAFxUwBUAF8AMAAyADYAYQAxAGMANwBjADUANAA4ADYANAA0ADkAMQA5
ADYAZgBmADUAMgBkADcANQA4ADYANAA3ADkANAAxAC4AUAByAG8AcABlAHIAdABpAGUAcwAuAFIA
ZQBzAG8AdQByAGMAZQBzAAAAAAC9lsteVqXdQrDTnl1SveXlAAQgAQEIAyAAAQUgAQEREQQgAQEO
BSABARFdCQcEAhI9EkESRQUgAQESbQQgAQECBCAAEnEFIAEBEkEEIAASeQQgABJ9CiAGAQgODg4I
EAIDIAAOBQACDg4OCCAFAggODg4ICAABEoCFEYCJBSAAEoCNByACAQ4SgI0It3pcVhk04IkIiYRd
zYCAzJEEAAAAAAQBAAAAAwYSVQMGElkDBhIQAgYIAwYRFAQAABJVBAAAElkFAAEBElkEAAASEAMA
AAEECAASVQQIABJZBAgAEhAIAQAIAAAAAAAeAQABAFQCFldyYXBOb25FeGNlcHRpb25UaHJvd3MB
CAEAAgAAAAAAKAEAI1NUXzAyNmExYzdjNTQ4NjQ0OTE5NmZmNTJkNzU4NjQ3OTQxAAAFAQAAAAAW
AQARQ29weXJpZ2h0IEAgIDIwMjUAAEkBABouTkVURnJhbWV3b3JrLFZlcnNpb249djQuNwEAVA4U
RnJhbWV3b3JrRGlzcGxheU5hbWUSLk5FVCBGcmFtZXdvcmsgNC43AAC0AAAAzsrvvgEAAACRAAAA
bFN5c3RlbS5SZXNvdXJjZXMuUmVzb3VyY2VSZWFkZXIsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4w
LjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0
ZW0uUmVzb3VyY2VzLlJ1bnRpbWVSZXNvdXJjZVNldAIAAAAAAAAAAAAAAFBBRFBBRFC0AAAAoDAA
AAAAAAAAAAAAujAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKwwAAAAAAAAAAAAAAAAX0NvckRs
bE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAAADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAA
AEgAAABYQAAAGgQAAAAAAAAAAAAAGgQ0AAAAVgBTAF8AVgBFAFIAUwBJAE8ATgBfAEkATgBGAE8A
AAAAAL0E7/4AAAEAAAABAIZSBSUAAAEAhlIFJT8AAAAAAAAABAAAAAIAAAAAAAAAAAAAAAAAAABE
AAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8A
bgAAAAAAAACwBHoDAAABAFMAdAByAGkAbgBnAEYAaQBsAGUASQBuAGYAbwAAAFYDAAABADAAMAAw
ADAAMAA0AGIAMAAAABoAAQABAEMAbwBtAG0AZQBuAHQAcwAAAAAAAAAiAAEAAQBDAG8AbQBwAGEA
bgB5AE4AYQBtAGUAAAAAAAAAAABwACQAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAA
AAAAUwBUAF8AMAAyADYAYQAxAGMANwBjADUANAA4ADYANAA0ADkAMQA5ADYAZgBmADUAMgBkADcA
NQA4ADYANAA3ADkANAAxAAAAPgAPAAEARgBpAGwAZQBWAGUAcgBzAGkAbwBuAAAAAAAxAC4AMAAu
ADkANAA3ADcALgAyADEAMQAyADYAAAAAAHAAKAABAEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAA
UwBUAF8AMgBiAGYAZQA3AGMAMABmADYAYQBhAGQANAA1AGUAYgA5ADAAOABkADgAOQA5ADAAZgA3
AGMAMwA3ADEANQAzAC4AZABsAGwAAABIABIAAQBMAGUAZwBhAGwAQwBvAHAAeQByAGkAZwBoAHQA
AABDAG8AcAB5AHIAaQBnAGgAdAAgAEAAIAAgADIAMAAyADUAAAAqAAEAAQBMAGUAZwBhAGwAVABy
AGEAZABlAG0AYQByAGsAcwAAAAAAAAAAAHgAKAABAE8AcgBpAGcAaQBuAGEAbABGAGkAbABlAG4A
YQBtAGUAAABTAFQAXwAyAGIAZgBlADcAYwAwAGYANgBhAGEAZAA0ADUAZQBiADkAMAA4AGQAOAA5
ADkAMABmADcAYwAzADcAMQA1ADMALgBkAGwAbAAAAGgAJAABAFAAcgBvAGQAdQBjAHQATgBhAG0A
ZQAAAAAAUwBUAF8AMAAyADYAYQAxAGMANwBjADUANAA4ADYANAA0ADkAMQA5ADYAZgBmADUAMgBk
ADcANQA4ADYANAA3ADkANAAxAAAAQgAPAAEAUAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAA
MQAuADAALgA5ADQANwA3AC4AMgAxADEAMgA2AAAAAABGAA8AAQBBAHMAcwBlAG0AYgBsAHkAIABW
AGUAcgBzAGkAbwBuAAAAMQAuADAALgA5ADQANwA3AC4AMgAxADEAMgA2AAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAADAAAAMwwAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</BinaryItem>
        </ScriptProject>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update_erp_temp133"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9583B7DE-6AC3-432E-AE0C-EC5A92968DB3}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update_erp_temp133"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="DECLARE @nowdate DATETIME = GETDATE();&#xA;DECLARE @yesterday DATETIME = DATEADD(DAY, -2, GETDATE());&#xA;DECLARE @yesterday_date INT = CONVERT(NCHAR(8), DATEADD(DAY, -2, GETDATE()), 112);&#xA;&#xA;-- === 2. Удаляем временную таблицу, если существует ===&#xA;IF OBJECT_ID(N'tempdb..#temp_DWH_KA0133_SSIS', N'U') IS NOT NULL&#xA;    DROP TABLE #temp_DWH_KA0133_SSIS;&#xA;&#xA;-- === 3. Заполняем временную таблицу из ERP через linked server ===&#xA;SELECT &#xA;    [KA0133_PLAN_DATUM],[KA0133_PROD_KST_NR],[KA0133_PRIORITAET],[KA0133_REZ_NR],[KA0133_VAR_NR],&#xA;    [KA0133_PROD_AUFTR_NR],[KA0133_PROD_AUFTR_LFD_NR],[KA0133_REC_NR],[KA0133_REZ_VERS_NR],&#xA;    [KA2422_CHARGEN_NR],[KA0133_ABG_KST_NR],[KA0133_STATUS],[KA0133_NF_REZ_NR],[KA0133_NF_VAR_NR],&#xA;    [KA0133_NF_PROD_AUFTR_NR],[KA0133_NF_PROD_AUFTR_LFD_NR],[KA0133_NF_PROD_KST_NR],&#xA;    [KA0133_CHAR_GR_SGE],[KA0133_GES_MENGE_SGE],[KA0133_PLAN_CHAR_GR],&#xA;    KA0133_START_DATUM_SOLL,KA0133_START_ZEIT_SOLL,KA0133_ENDE_DATUM_SOLL,KA0133_ENDE_ZEIT_SOLL,&#xA;    [KA0133_START_DATUM_IST],[KA0133_START_ZEIT_IST],[KA0133_ENDE_DATUM_IST],[KA0133_ENDE_ZEIT_IST],&#xA;    [KA0133_MHD],[KA0133_ANZ_CHARGEN],[KA0133_ANZ_CHARGEN_GENAU],[KA0133_ANZ_CHARGEN_IST],&#xA;    [KA0133_FA_BS_NR],[KA0133_FA_ADR_NR],[KA0133_VAR_ERM],[KA0133_GEDRUCKT],&#xA;    [KA0133_CFG_GEN_CH_POSTEN],[KA0133_CFG_CH_P_EMPF_LT],[KA0133_ANL_DATUM],[KA0133_ANL_ZEIT],&#xA;    [KA0133_ANL_USER],[KA0133_UPD_DATUM],[KA0133_UPD_ZEIT],[KA0133_UPD_USER]&#xA;INTO #temp_DWH_KA0133_SSIS &#xA;FROM [11-VM-CSBSQL].[CSB].[dbo].[ka2422_00102] WITH (NOLOCK)&#xA;JOIN [11-VM-CSBSQL].[CSB].[dbo].[ka0133_00113] WITH (NOLOCK) &#xA;    ON [KA0133_PROD_AUFTR_NR] = [KA2422_PROD_AUFTR_NR] &#xA;    AND [KA0133_PROD_AUFTR_LFD_NR] = [KA2422_PROD_AUFTR_NR_LFD]&#xA;WHERE KA2422_CHARGEN_NR IS NOT NULL &#xA;  AND dbo.Convert_CSB_Date_Time(KA0133_UPD_DATUM, KA0133_UPD_ZEIT) &gt;= @yesterday;&#xA;&#xA;-- === 4. Обновляем существующие строки ===&#xA;UPDATE target&#xA;SET &#xA;    KA0133_PLAN_DATUM = source.KA0133_PLAN_DATUM,&#xA;    KA0133_PROD_KST_NR = source.KA0133_PROD_KST_NR,&#xA;    KA0133_PRIORITAET = source.KA0133_PRIORITAET,&#xA;    KA0133_REZ_NR = source.KA0133_REZ_NR,&#xA;    KA0133_VAR_NR = source.KA0133_VAR_NR,&#xA;    KA0133_PROD_AUFTR_NR = source.KA0133_PROD_AUFTR_NR,&#xA;    KA0133_PROD_AUFTR_LFD_NR = source.KA0133_PROD_AUFTR_LFD_NR,&#xA;    KA0133_REC_NR = source.KA0133_REC_NR,&#xA;    KA0133_REZ_VERS_NR = source.KA0133_REZ_VERS_NR,&#xA;    KA2422_CHARGEN_NR = source.KA2422_CHARGEN_NR,&#xA;    KA0133_ABG_KST_NR = source.KA0133_ABG_KST_NR,&#xA;    KA0133_STATUS = source.KA0133_STATUS,&#xA;    KA0133_NF_REZ_NR = source.KA0133_NF_REZ_NR,&#xA;    KA0133_NF_VAR_NR = source.KA0133_NF_VAR_NR,&#xA;    KA0133_NF_PROD_AUFTR_NR = source.KA0133_NF_PROD_AUFTR_NR,&#xA;    KA0133_NF_PROD_AUFTR_LFD_NR = source.KA0133_NF_PROD_AUFTR_LFD_NR,&#xA;    KA0133_NF_PROD_KST_NR = source.KA0133_NF_PROD_KST_NR,&#xA;    KA0133_CHAR_GR_SGE = source.KA0133_CHAR_GR_SGE,&#xA;    KA0133_GES_MENGE_SGE = source.KA0133_GES_MENGE_SGE,&#xA;    KA0133_PLAN_CHAR_GR = source.KA0133_PLAN_CHAR_GR,&#xA;    KA0133_START_DATUM_SOLL = source.KA0133_START_DATUM_SOLL,&#xA;    KA0133_START_ZEIT_SOLL = source.KA0133_START_ZEIT_SOLL,&#xA;    KA0133_ENDE_DATUM_SOLL = source.KA0133_ENDE_DATUM_SOLL,&#xA;    KA0133_ENDE_ZEIT_SOLL = source.KA0133_ENDE_ZEIT_SOLL,&#xA;    KA0133_START_DATUM_IST = source.KA0133_START_DATUM_IST,&#xA;    KA0133_START_ZEIT_IST = source.KA0133_START_ZEIT_IST,&#xA;    KA0133_ENDE_DATUM_IST = source.KA0133_ENDE_DATUM_IST,&#xA;    KA0133_ENDE_ZEIT_IST = source.KA0133_ENDE_ZEIT_IST,&#xA;    KA0133_MHD = source.KA0133_MHD,&#xA;    KA0133_ANZ_CHARGEN = source.KA0133_ANZ_CHARGEN,&#xA;    KA0133_ANZ_CHARGEN_GENAU = source.KA0133_ANZ_CHARGEN_GENAU,&#xA;    KA0133_ANZ_CHARGEN_IST = source.KA0133_ANZ_CHARGEN_IST,&#xA;    KA0133_FA_BS_NR = source.KA0133_FA_BS_NR,&#xA;    KA0133_FA_ADR_NR = source.KA0133_FA_ADR_NR,&#xA;    KA0133_VAR_ERM = source.KA0133_VAR_ERM,&#xA;    KA0133_GEDRUCKT = source.KA0133_GEDRUCKT,&#xA;    KA0133_CFG_GEN_CH_POSTEN = source.KA0133_CFG_GEN_CH_POSTEN,&#xA;    KA0133_CFG_CH_P_EMPF_LT = source.KA0133_CFG_CH_P_EMPF_LT,&#xA;    KA0133_ANL_DATUM = source.KA0133_ANL_DATUM,&#xA;    KA0133_ANL_ZEIT = source.KA0133_ANL_ZEIT,&#xA;    KA0133_ANL_USER = source.KA0133_ANL_USER,&#xA;    KA0133_UPD_DATUM = source.KA0133_UPD_DATUM,&#xA;    KA0133_UPD_ZEIT = source.KA0133_UPD_ZEIT,&#xA;    KA0133_UPD_USER = source.KA0133_UPD_USER&#xA;FROM temp_DWH_KA0133_SSIS AS target&#xA;INNER JOIN #temp_DWH_KA0133_SSIS AS source&#xA;    ON target.KA0133_REC_NR = source.KA0133_REC_NR&#xA;    AND target.KA2422_CHARGEN_NR = source.KA2422_CHARGEN_NR;&#xA;&#xA;-- === 5. Вставляем новые строки ===&#xA;INSERT INTO temp_DWH_KA0133_SSIS&#xA;SELECT source.*&#xA;FROM #temp_DWH_KA0133_SSIS AS source&#xA;WHERE NOT EXISTS (&#xA;    SELECT 1&#xA;    FROM temp_DWH_KA0133_SSIS AS target&#xA;    WHERE target.KA0133_REC_NR = source.KA0133_REC_NR&#xA;      AND target.KA2422_CHARGEN_NR = source.KA2422_CHARGEN_NR&#xA;);&#xA;&#xA;-- === 6. Очистка (если нужно) ===&#xA;DELETE FROM temp_DWH_KA0133_SSIS &#xA;WHERE KA0133_STATUS IN (1, 3) &#xA;   OR KA0133_PLAN_CHAR_GR = 1 &#xA;   OR (NOT EXISTS (&#xA;        SELECT 1 &#xA;        FROM [11-VM-CSBSQL].[CSB].[dbo].[ka0133_00113] WITH (NOLOCK)&#xA;        WHERE temp_DWH_KA0133_SSIS.KA0133_REC_NR = KA0133_REC_NR&#xA;      ) &#xA;      AND KA0133_PLAN_DATUM &gt;= CONVERT(INT, CONVERT(CHAR(8), DATEADD(MONTH, -1, GETDATE()), 112))&#xA;     );" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update_erp_temp2461"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4ac1e13b-306e-412a-96e0-2fd171d3479f}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update_erp_temp2461"
      DTS:ThreadHint="4">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{15E5B8D5-5D7C-40CD-A746-AB4423273A56}"
          SQLTask:SqlStatementSource="declare @nowdate datetime = GETDATE() ,@yesterday datetime = DATEADD(DAY,-2,GETDATE())&#xA;&#x9;declare @yesterday_date int = convert(nchar(8),dateadd(DAY,-2,getdate()),112)&#xA;&#xA;&#x9;&#xA;&#x9;IF object_id(N'tempdb..#temp_DWH_KA2461_KA2446_SSIS', N'U') is not null drop table dbo.#temp_DWH_KA2461_KA2446_SSIS;&#xA;&#x9;--IF OBJECT_ID(N'tempdb..#temp_DWH_KA2438_2439', N'U') is not null BEGIN drop table dbo.#temp_DWH_KA2438_2439 END&#xA;&#x9;&#xA;&#x9;&#xA;IF OBJECT_ID (N'dbo.temp_DWH_KA2461_KA2446_SSIS', N'U') is null create table dbo.temp_DWH_KA2461_KA2446_SSIS (&#x9;&#xA;&#x9;KA2461_CHAR_NR  bigint not null--Номер партии&#xA;&#x9;,KA2461_PROD_AUFTR_NR bigint not null --Номер задания&#xA;&#x9;,KA2461_PROD_AUFTR_LFD_NR smallint not null --номер подзадания&#xA;&#x9;,KA2461_MAX_UNIQUE_NR int not null--количество компонентов&#xA;&#x9;,KA2461_STATUS tinyint not null --Статус партии&#xA;&#x9;,KA2461_PROD_KST_NR int not null --Буфер производства&#xA;&#x9;,KA2461_PROD_LT_NR bigint not null--?&#xA;&#x9;,KA2461_PROD_LT_DATUM int not null--Дата буфера производства&#xA;&#x9;,KA2461_PROD_LT_LOS nchar(20)--ЛОТ буфера производства&#xA;&#x9;,KA2461_EMPF_KST_NR int not null --Буфер выхода&#xA;&#x9;,KA2461_EMPF_LT_NR bigint not null--? Номер буфера выхода&#xA;&#x9;,KA2461_EMPF_LT_DATUM int not null--Дата буфера выхода&#xA;&#x9;,KA2461_EMPF_LT_LOS nchar(20)--ЛОТ буфера выхода&#xA;&#x9;,KA2461_REZ_NR bigint not null--Артикул спецификации&#xA;&#x9;,KA2461_VAR_NR smallint not null--Вариант спецификации&#xA;&#x9;,KA2461_REZ_VERS_NR bigint not null--Версия варианта спецификации&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_BRU decimal(18,6) not null--Общий вес сацификации БРУТТО&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_NET decimal(18,6) not null--Общий вес спецификации НЕТТО&#xA;&#x9;,KA2461_REZ_STUECK_KALK tinyint not null --Калькуляционный код спецификации&#xA;&#x9;,KA2461_CHAR_GR_SOLL_PE_VK  decimal(18,6)--Объем производства ПЛАН&#xA;&#x9;,KA2461_CHAR_GR_IST_LE_VK decimal(18,6)--Объем производства, ФАКТ, СК&#xA;&#x9;,KA2461_CHAR_GR_IST_PE_VK  decimal(18,6)--Объем производства, ФАКТ, ЦЕ&#xA;&#x9;,KA2461_MHD int not null--Дата ОСГ&#xA;&#x9;,KA2461_PRIORITAET int not null--Приоритет производства&#xA;&#x9;,KA2461_START_DATUM_IST int not null&#xA;&#x9;,KA2461_START_ZEIT_IST int not null&#xA;&#x9;,KA2461_ENDE_DATUM_IST int not null&#xA;&#x9;,KA2461_ENDE_ZEIT_IST int not null&#xA;&#x9;,KA2461_UEBERN_STAT tinyint not null&#xA;&#x9;,KA2461_GEDRUCKT tinyint not null&#xA;&#x9;,KA2461_LAGERPREIS decimal(13,6)--цена&#xA;&#x9;,KA2461_WAEHRUNG nchar(4) not null--руб&#xA;&#x9;,KA2446_MENGE_KG_1 decimal(15,6) null--Объем (кг) 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_AKT_1 decimal(15,6) null--Цена ФАКТ 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_DUR_1 decimal(15,6) null--Цена ПЛАН 1 ступень (сырье)&#xA;&#x9;,KA2446_WERT_PRO_1 decimal(15,6) null--Цена СЕ 1 ступень (сырье)&#xA;&#x9;,KA2446_MENGE_KG_3 decimal(15,3) null--Объем (кг) 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_AKT_3 decimal(15,6) null--Цена ФАКТ 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_DUR_3 decimal(15,6) null--Цена ПЛАН 3 ступень (упаковка)&#xA;&#x9;,KA2446_WERT_PRO_3 decimal(15,6) null--Цена СЕ 3 ступень (упаковка)&#xA;&#x9;,KA2461_ANL_DATUM int not null&#xA;&#x9;,KA2461_ANL_ZEIT int not null&#xA;&#x9;,KA2461_UPD_DATUM int not null&#xA;&#x9;,KA2461_UPD_ZEIT int not null&#xA;&#x9;,KA2461_UPD_USER int not null)&#xA;&#xA;select KA2461_CHAR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_NR&#xA;&#x9;,KA2461_PROD_AUFTR_LFD_NR&#xA;&#x9;,KA2461_MAX_UNIQUE_NR&#xA;&#x9;,KA2461_STATUS&#xA;&#x9;,KA2461_PROD_KST_NR&#xA;&#x9;,KA2461_PROD_LT_NR&#xA;&#x9;,KA2461_PROD_LT_DATUM&#xA;&#x9;,KA2461_PROD_LT_LOS&#xA;&#x9;,KA2461_EMPF_KST_NR&#xA;&#x9;,KA2461_EMPF_LT_NR&#xA;&#x9;,KA2461_EMPF_LT_DATUM&#xA;&#x9;,KA2461_EMPF_LT_LOS&#xA;&#x9;,KA2461_REZ_NR&#xA;&#x9;,KA2461_VAR_NR&#xA;&#x9;,KA2461_REZ_VERS_NR&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_BRU&#xA;&#x9;,KA2461_REZ_GES_GEW_SGE_NET&#xA;&#x9;,KA2461_REZ_STUECK_KALK&#xA;&#x9;,KA2461_CHAR_GR_SOLL_PE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_LE_VK&#xA;&#x9;,KA2461_CHAR_GR_IST_PE_VK&#xA;&#x9;,KA2461_MHD&#xA;&#x9;,KA2461_PRIORITAET&#xA;&#x9;,KA2461_START_DATUM_IST&#xA;&#x9;,KA2461_START_ZEIT_IST&#xA;&#x9;,KA2461_ENDE_DATUM_IST &#xA;&#x9;,KA2461_ENDE_ZEIT_IST&#xA;&#x9;,KA2461_UEBERN_STAT&#xA;&#x9;,KA2461_GEDRUCKT &#xA;&#x9;,KA2461_LAGERPREIS &#xA;&#x9;,KA2461_WAEHRUNG &#xA;&#x9;,KA2446_MENGE_KG_1  &#xA;&#x9;,KA2446_WERT_AKT_1  &#xA;&#x9;,KA2446_WERT_DUR_1  &#xA;&#x9;,KA2446_WERT_PRO_1  &#xA;&#x9;,KA2446_MENGE_KG_3  &#xA;&#x9;,KA2446_WERT_AKT_3  &#xA;&#x9;,KA2446_WERT_DUR_3  &#xA;&#x9;,KA2446_WERT_PRO_3 &#xA;&#x9;,KA2461_ANL_DATUM &#xA;&#x9;,KA2461_ANL_ZEIT&#xA;&#x9;,KA2461_UPD_DATUM&#xA;&#x9;,KA2461_UPD_ZEIT&#xA;&#x9;,KA2461_UPD_USER&#xA;into [dbo].#temp_DWH_KA2461_KA2446_SSIS from [CSB].[dbo].[ka2461_00105] with(nolock) left join [CSB].[dbo].[KA2446_00103] with(nolock) on KA2461_CHAR_NR = KA2446_CHARGEN_NR&#xA;&#x9;where dbo.Convert_CSB_Date_Time(KA2461_UPD_DATUM, KA2461_UPD_ZEIT) &gt;= @yesterday&#xA;&#x9;&#x9;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{DFDF0DFF-2BC0-4DD7-82A9-F76C054B6C51}"
      DTS:From="Package\Update_erp_temp2461"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\from_temp_erp_to_t_erp 2461" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{890A20D0-7F94-42BC-BBF2-6D0948487D4F}"
      DTS:From="Package\Update_erp_temp133"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\from_temp_erp_to_t_dwh" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{83f1e9f1-0f51-4d87-a01f-47bdbb6fe40f}"
      DTS:EvalOp="3"
      DTS:Expression="@[User::HasMismatches] == 1"
      DTS:From="Package\CheckCollisions52"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\Script Task" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{25D8A24B-E98E-4221-8DFD-F1BE77CBE456}"
      DTS:From="Package\insert_from_temp_csb_to_dwh52"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\CheckCollisions52" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{16BE8837-15FF-4322-8D70-20BABFF01F89}"
      DTS:From="Package\CheckCollisions133"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\Finall etl proces" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 13]"
      DTS:CreationName=""
      DTS:DTSID="{858F0FDC-096E-4F78-9AC1-796817DC1EC2}"
      DTS:EvalOp="3"
      DTS:Expression="@[User::HasMismatches] == 0"
      DTS:From="Package\CheckCollisions52"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 13"
      DTS:To="Package\Finall etl proces" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 14]"
      DTS:CreationName=""
      DTS:DTSID="{F18482CE-D84A-43A1-9205-4EF65E174749}"
      DTS:From="Package\Healing DWH2462"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 14"
      DTS:To="Package\Finall etl proces" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 15]"
      DTS:CreationName=""
      DTS:DTSID="{583BF72B-E1F8-48F9-BC00-A046B4499535}"
      DTS:From="Package\Script Task"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 15"
      DTS:To="Package\Finall etl proces" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{2A9DD6B6-C74A-49FA-9C9F-556E17297007}"
      DTS:From="Package\from_temp_erp_to_t_erp 2461"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\from_temp_erp_to_t_dwh 2461" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{9C98DF9B-7C01-4771-9F12-E809D3DF1BEE}"
      DTS:From="Package\insert_from_csb_to_temp_csb2462"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\insert_from_temp_csb_to_dwh2462" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{3B3A2126-7111-474F-80F0-0BEEF144FEE7}"
      DTS:From="Package\insert_from_csb_to_temp_csb6500"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\insert_from_temp_csb_to_dwh6500" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{105B97C8-CE0B-4CD9-A7E3-D75C86B56CE3}"
      DTS:From="Package\insert_from_CSB_52"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\insert_from_temp_csb_to_dwh52" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{A0E6A4CA-CE67-491D-9838-0AD03CF0BFC7}"
      DTS:From="Package\from_temp_erp_to_t_dwh"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\CheckCollisions133" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{E27D95A1-FFC2-4BB4-A5CF-D8281AE049DC}"
      DTS:From="Package\insert_from_temp_csb_to_dwh6500"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Finall etl proces" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{D3F06562-234D-4C71-B135-15A64FB2DCA2}"
      DTS:From="Package\insert_from_temp_csb_to_dwh2462"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\Healing DWH2462" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{C937AAC0-979D-4BE9-B85D-D7914E636559}"
      DTS:From="Package\from_temp_erp_to_t_dwh 2461"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\Finall etl proces" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{56E7D64F-B9AD-4188-9C49-F10990E232C4}"
      DTS:EventID="730953656"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{737ECE9F-D5E3-4ADF-B690-583F8EDD1A70}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Send Mail Task"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{FB5F2E29-92AE-47CC-9FCE-07AAE6549C9E}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Mail Task">
          <DTS:Variables />
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{ED11153F-0C94-48DD-BF81-8408FF4777E8}"
              SendMailTask:From="a.d.rogov@agrohold.ru"
              SendMailTask:To="a.d.rogov@agrohold.ru"
              SendMailTask:CC="[SSIS ETL ERROR] Пакет {PackageName} упал"
              SendMailTask:MessageSource="&quot;Пакет: &quot; + @[System::PackageName] + &quot;\r\n&quot; +&#xA;&quot;Время начала: &quot; + (DT_WSTR, 50) @[System::StartTime] + &quot;\r\n&quot; +&#xA;&quot;Время окончания: &quot; + (DT_WSTR, 50)@[System::EndTime] + &quot;\r\n&quot; +&#xA;&quot;Описание ошибки: \r\n&quot; + @[System::ErrorDescription] + &quot;\r\n\r\n&quot; +&#xA;&quot;Идентификатор задачи: &quot; + @[System::TaskName] + &quot;\r\n&quot; +&#xA;&quot;Код ошибки: &quot; + (DT_WSTR, 50) @[System::ErrorCode] + &quot;\r\n\r\n&quot; +&#xA;&quot;Имя компьютера: &quot; + @[System::MachineName] + &quot;\r\n&quot; +&#xA;&quot;Пользователь: &quot; + @[System::UserName]" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="176,42"
          Id="Package\CheckCollisions133"
          TopLeft="109,324" />
        <NodeLayout
          Size="170,42"
          Id="Package\CheckCollisions52"
          TopLeft="1001.94444444444,434.305555555556" />
        <NodeLayout
          Size="156,42"
          Id="Package\Finall etl proces"
          TopLeft="448.194444444444,483.194444444444" />
        <NodeLayout
          Size="204,42"
          Id="Package\from_temp_erp_to_t_dwh"
          TopLeft="17,159" />
        <NodeLayout
          Size="232,52"
          Id="Package\from_temp_erp_to_t_dwh 2461"
          TopLeft="296.714285714286,195.857142857143" />
        <NodeLayout
          Size="227,42"
          Id="Package\from_temp_erp_to_t_erp 2461"
          TopLeft="212,113" />
        <NodeLayout
          Size="181,42"
          Id="Package\insert_from_CSB_52"
          TopLeft="1025.7380952381,69.6309523809524" />
        <NodeLayout
          Size="251,42"
          Id="Package\insert_from_csb_to_temp_csb2462"
          TopLeft="448,17" />
        <NodeLayout
          Size="251,42"
          Id="Package\insert_from_csb_to_temp_csb6500"
          TopLeft="732.111111111111,26" />
        <NodeLayout
          Size="235,42"
          Id="Package\insert_from_temp_csb_to_dwh2462"
          TopLeft="463,138.666666666667" />
        <NodeLayout
          Size="263,42"
          Id="Package\insert_from_temp_csb_to_dwh52"
          TopLeft="948.067460317461,259.293650793651" />
        <NodeLayout
          Size="235,42"
          Id="Package\insert_from_temp_csb_to_dwh6500"
          TopLeft="630.174603174603,233.730158730158" />
        <NodeLayout
          Size="134,42"
          Id="Package\Script Task"
          TopLeft="964.111111111111,558.277777777778" />
        <NodeLayout
          Size="185,42"
          Id="Package\Update_erp_temp133"
          TopLeft="46,47" />
        <NodeLayout
          Size="191,42"
          Id="Package\Update_erp_temp2461"
          TopLeft="248,20" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="343.5,62">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-18,51"
              Start="0,0"
              End="-18,43.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,21.5"
                    Point2="0,25.5"
                    Point3="-4,25.5" />
                  <mssgle:LineSegment
                    End="-14,25.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-14,25.5"
                    Point2="-18,25.5"
                    Point3="-18,29.5" />
                  <mssgle:LineSegment
                    End="-18,43.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="138.5,89">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-19.5,70"
              Start="0,0"
              End="-19.5,62.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31"
                    Point2="0,35"
                    Point3="-4,35" />
                  <mssgle:LineSegment
                    End="-15.5,35" />
                  <mssgle:CubicBezierSegment
                    Point1="-15.5,35"
                    Point2="-19.5,35"
                    Point3="-19.5,39" />
                  <mssgle:LineSegment
                    End="-19.5,62.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="1086.94444444444,476.305555555556">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-55.8333333333292,81.9722222222222"
              Start="0,0"
              End="-55.8333333333292,74.4722222222222">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.9861111111111" />
                  <mssgle:CubicBezierSegment
                    Point1="0,36.9861111111111"
                    Point2="0,40.9861111111111"
                    Point3="-4,40.9861111111111" />
                  <mssgle:LineSegment
                    End="-51.8333333333292,40.9861111111111" />
                  <mssgle:CubicBezierSegment
                    Point1="-51.8333333333292,40.9861111111111"
                    Point2="-55.8333333333292,40.9861111111111"
                    Point3="-55.8333333333292,44.9861111111111" />
                  <mssgle:LineSegment
                    End="-55.8333333333292,74.4722222222222" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-35.9166666666646,45.9861111111111,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="1083.25595238095,301.293650793651">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,133.011904761905"
              Start="0,0"
              End="0,125.511904761905">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,125.511904761905" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="197,366">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="287.594444444444,117.194444444444"
              Start="0,0"
              End="287.594444444444,109.694444444444">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,78.0554182683504" />
                  <mssgle:CubicBezierSegment
                    Point1="0,78.0554182683504"
                    Point2="0,82.0554182683504"
                    Point3="4,82.0554182683504" />
                  <mssgle:LineSegment
                    End="283.594444444444,82.0554182683504" />
                  <mssgle:CubicBezierSegment
                    Point1="283.594444444444,82.0554182683504"
                    Point2="287.594444444444,82.0554182683504"
                    Point3="287.594444444444,86.0554182683504" />
                  <mssgle:LineSegment
                    End="287.594444444444,109.694444444444" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 13]"
          TopLeft="1001.94444444444,455.305555555556">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-383.749999999996,48.888888888888"
              Start="0,0"
              End="-376.249999999996,48.888888888888">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-187.874999999998,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-187.874999999998,0"
                    Point2="-191.874999999998,0"
                    Point3="-191.874999999998,4" />
                  <mssgle:LineSegment
                    End="-191.874999999998,44.888888888888" />
                  <mssgle:CubicBezierSegment
                    Point1="-191.874999999998,44.888888888888"
                    Point2="-191.874999999998,48.888888888888"
                    Point3="-195.874999999998,48.888888888888" />
                  <mssgle:LineSegment
                    End="-376.249999999996,48.888888888888" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-199.874999999998,-22,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="325.5,155">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="87.2142857142858,40.8571428571428"
              Start="0,0"
              End="87.2142857142858,33.3571428571428">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.4285714285714" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.4285714285714"
                    Point2="0,20.4285714285714"
                    Point3="4,20.4285714285714" />
                  <mssgle:LineSegment
                    End="83.2142857142858,20.4285714285714" />
                  <mssgle:CubicBezierSegment
                    Point1="83.2142857142858,20.4285714285714"
                    Point2="87.2142857142858,20.4285714285714"
                    Point3="87.2142857142858,24.4285714285714" />
                  <mssgle:LineSegment
                    End="87.2142857142858,33.3571428571428" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="577,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,79.6666666666667"
              Start="0,0"
              End="0,72.1666666666667">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,72.1666666666667" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="857.611111111111,68">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-109.936507936508,165.730158730158"
              Start="0,0"
              End="-109.936507936508,158.230158730158">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,78.8650793650791" />
                  <mssgle:CubicBezierSegment
                    Point1="0,78.8650793650791"
                    Point2="0,82.8650793650791"
                    Point3="-4,82.8650793650791" />
                  <mssgle:LineSegment
                    End="-105.936507936508,82.8650793650791" />
                  <mssgle:CubicBezierSegment
                    Point1="-105.936507936508,82.8650793650791"
                    Point2="-109.936507936508,82.8650793650791"
                    Point3="-109.936507936508,86.8650793650791" />
                  <mssgle:LineSegment
                    End="-109.936507936508,158.230158730158" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="1116.2380952381,111.630952380952">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-36.6706349206388,147.662698412699"
              Start="0,0"
              End="-36.6706349206388,140.162698412699">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,69.8313492063493" />
                  <mssgle:CubicBezierSegment
                    Point1="0,69.8313492063493"
                    Point2="0,73.8313492063493"
                    Point3="-4,73.8313492063493" />
                  <mssgle:LineSegment
                    End="-32.6706349206388,73.8313492063493" />
                  <mssgle:CubicBezierSegment
                    Point1="-32.6706349206388,73.8313492063493"
                    Point2="-36.6706349206388,73.8313492063493"
                    Point3="-36.6706349206388,77.8313492063493" />
                  <mssgle:LineSegment
                    End="-36.6706349206388,140.162698412699" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="119,201">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="78,123"
              Start="0,0"
              End="78,115.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,57.5"
                    Point2="0,61.5"
                    Point3="4,61.5" />
                  <mssgle:LineSegment
                    End="74,61.5" />
                  <mssgle:CubicBezierSegment
                    Point1="74,61.5"
                    Point2="78,61.5"
                    Point3="78,65.5" />
                  <mssgle:LineSegment
                    End="78,115.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="412.714285714286,247.857142857143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="104.280158730158,235.337301587301"
              Start="0,0"
              End="104.280158730158,227.837301587301">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,126.062877990381" />
                  <mssgle:CubicBezierSegment
                    Point1="0,126.062877990381"
                    Point2="0,130.062877990381"
                    Point3="4,130.062877990381" />
                  <mssgle:LineSegment
                    End="100.280158730158,130.062877990381" />
                  <mssgle:CubicBezierSegment
                    Point1="100.280158730158,130.062877990381"
                    Point2="104.280158730158,130.062877990381"
                    Point3="104.280158730158,134.062877990381" />
                  <mssgle:LineSegment
                    End="104.280158730158,227.837301587301" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="747.674603174603,275.730158730158">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-165.880158730159,207.464285714286"
              Start="0,0"
              End="-165.880158730159,199.964285714286">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,141.259178630266" />
                  <mssgle:CubicBezierSegment
                    Point1="0,141.259178630266"
                    Point2="0,145.259178630266"
                    Point3="-4,145.259178630266" />
                  <mssgle:LineSegment
                    End="-161.880158730159,145.259178630266" />
                  <mssgle:CubicBezierSegment
                    Point1="-161.880158730159,145.259178630266"
                    Point2="-165.880158730159,145.259178630266"
                    Point3="-165.880158730159,149.259178630266" />
                  <mssgle:LineSegment
                    End="-165.880158730159,199.964285714286" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="179,42"
          Id="Package\Healing DWH2462"
          TopLeft="480,282.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="580.5,180.666666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-11,101.833333333333"
              Start="0,0"
              End="-11,94.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.9166666666665" />
                  <mssgle:CubicBezierSegment
                    Point1="0,46.9166666666665"
                    Point2="0,50.9166666666665"
                    Point3="-4,50.9166666666665" />
                  <mssgle:LineSegment
                    End="-7,50.9166666666665" />
                  <mssgle:CubicBezierSegment
                    Point1="-7,50.9166666666665"
                    Point2="-11,50.9166666666665"
                    Point3="-11,54.9166666666665" />
                  <mssgle:LineSegment
                    End="-11,94.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 14]"
          TopLeft="569.5,324.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-20.105555555556,158.694444444444"
              Start="0,0"
              End="-20.105555555556,151.194444444444">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,83.7049920531713" />
                  <mssgle:CubicBezierSegment
                    Point1="0,83.7049920531713"
                    Point2="0,87.7049920531713"
                    Point3="-4,87.7049920531713" />
                  <mssgle:LineSegment
                    End="-16.105555555556,87.7049920531713" />
                  <mssgle:CubicBezierSegment
                    Point1="-16.105555555556,87.7049920531713"
                    Point2="-20.105555555556,87.7049920531713"
                    Point3="-20.105555555556,91.7049920531713" />
                  <mssgle:LineSegment
                    End="-20.105555555556,151.194444444444" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 15]"
          TopLeft="1010.11111111111,558.277777777778">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-476.916666666667,-33.0833333333342"
              Start="0,0"
              End="-476.916666666667,-25.5833333333342">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-9.46755162241922" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-9.46755162241922"
                    Point2="0,-13.4675516224192"
                    Point3="-4,-13.4675516224192" />
                  <mssgle:LineSegment
                    End="-472.916666666667,-13.4675516224192" />
                  <mssgle:CubicBezierSegment
                    Point1="-472.916666666667,-13.4675516224192"
                    Point2="-476.916666666667,-13.4675516224192"
                    Point3="-476.916666666667,-17.4675516224192" />
                  <mssgle:LineSegment
                    End="-476.916666666667,-25.5833333333342" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="155,42"
          Id="Package.EventHandlers[OnError]\Send Mail Task"
          TopLeft="260,102" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>